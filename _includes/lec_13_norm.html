<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" href="{{ 'assets/coqdoc.css' | relative_url }}">
<title>lec_13_norm</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">


<div class="doc">
<a id="lab1"></a>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#"><span class="id" title="library">Lists.List</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#"><span class="id" title="library">Strings.String</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Maps</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Multi</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab2"></a><h2 class="section">References</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> https://softwarefoundations.cis.upenn.edu/plf-current/Norm.html

</li>
</ul>

<div class="paragraph"> </div>

 
<div class="paragraph"> </div>

<a id="lab3"></a><h2 class="section">Recap</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Last time we finished off our section on types.

</li>
<li> Today, we'll look into a powerful proof technique called <i>logical relations</i>.

</li>
</ul>

<div class="paragraph"> </div>

 
<div class="paragraph"> </div>

<a id="lab4"></a><h2 class="section">Goal for today</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Introduce the idea of <i>logical relations</i>, a powerful proof technique
     that can be used to obtain a stronger induction hypothesis.
<ul class="doclist">
<li> This technique can be used to show that STLC is strongly normalizing,
     i.e., that every well-typed STLC term terminates.

</li>
<li> We will also show how to use this technique to give another proof of
     type-soundness for STLC.

</li>
<li> Along the way, we'll encounter many concepts we've seen throughout this
     class.

</li>
</ul>

</li>
</ul>

<div class="paragraph"> </div>

 
<div class="paragraph"> </div>

<a id="lab5"></a><h2 class="section">STLC Recap</h2>

<div class="paragraph"> </div>

<a id="lab6"></a><h3 class="section">Types</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="ty" class="idref" href="#ty"><span class="id" title="inductive">ty</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
| <a id="Ty_Bool" class="idref" href="#Ty_Bool"><span class="id" title="constructor">Ty_Bool</span></a> : <a class="idref" href="lec_13_norm.html#ty:1"><span class="id" title="inductive">ty</span></a>                 <span class="comment">(*&nbsp;Bool&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
| <a id="Ty_Arrow" class="idref" href="#Ty_Arrow"><span class="id" title="constructor">Ty_Arrow</span></a> : <a class="idref" href="lec_13_norm.html#ty:1"><span class="id" title="inductive">ty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#ty:1"><span class="id" title="inductive">ty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#ty:1"><span class="id" title="inductive">ty</span></a>    <span class="comment">(*&nbsp;T1&nbsp;-&gt;&nbsp;T2&nbsp;&nbsp;*)</span><br/>
.<br/>

<br/>
</div>

<div class="doc">
<a id="lab7"></a><h3 class="section">Terms</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="tm" class="idref" href="#tm"><span class="id" title="inductive">tm</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
<span class="comment">(*&nbsp;pure&nbsp;STLC&nbsp;*)</span><br/>
| <a id="tm_var" class="idref" href="#tm_var"><span class="id" title="constructor">tm_var</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a>               <span class="comment">(*&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
| <a id="tm_app" class="idref" href="#tm_app"><span class="id" title="constructor">tm_app</span></a> : <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a>             <span class="comment">(*&nbsp;t1&nbsp;t2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
| <a id="tm_abs" class="idref" href="#tm_abs"><span class="id" title="constructor">tm_abs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#ty"><span class="id" title="inductive">ty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a>   <span class="comment">(*&nbsp;\x:T1,&nbsp;t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;booleans&nbsp;*)</span><br/>
| <a id="tm_true" class="idref" href="#tm_true"><span class="id" title="constructor">tm_true</span></a> : <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a>                        <span class="comment">(*&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
| <a id="tm_false" class="idref" href="#tm_false"><span class="id" title="constructor">tm_false</span></a> : <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a>                       <span class="comment">(*&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
| <a id="tm_if" class="idref" href="#tm_if"><span class="id" title="constructor">tm_if</span></a> : <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm:3"><span class="id" title="inductive">tm</span></a>        <span class="comment">(*&nbsp;if&nbsp;t1&nbsp;t2&nbsp;t3&nbsp;&nbsp;&nbsp;*)</span><br/>
.<br/>

<br/>
</div>

<div class="doc">
<a id="lab8"></a><h3 class="section">Notation</h3>

</div>
<div class="code">

<br/>
<span class="id" title="var">Declare</span> <span class="id" title="var">Custom</span> <span class="id" title="var">Entry</span> <span class="id" title="var">stlc</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="96e24cc1b3765f349012b832d1dd22ad" class="idref" href="#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&quot;</span></a>&lt;{ e }&gt;" := <span class="id" title="var">e</span> (<span class="id" title="var">e</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99).<br/>
<span class="id" title="keyword">Notation</span> <a id="b1345b4aefd9f042fe48f55d08e97df9" class="idref" href="#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">&quot;</span></a>( x )" := <span class="id" title="var">x</span> (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span>, <span class="id" title="var">x</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99).<br/>
<span class="id" title="keyword">Notation</span> <a id=":stlc::x" class="idref" href="#:stlc::x"><span class="id" title="notation">&quot;</span></a>x" := <span class="id" title="var">x</span> (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0, <span class="id" title="var">x</span> <span class="id" title="keyword">constr</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0).<br/>
<span class="id" title="keyword">Notation</span> <a id=":stlc::x_'-&gt;'_x" class="idref" href="#:stlc::x_'-&gt;'_x"><span class="id" title="notation">&quot;</span></a>S -&gt; T" := (<a class="idref" href="lec_13_norm.html#Ty_Arrow"><span class="id" title="constructor">Ty_Arrow</span></a> <span class="id" title="var">S</span> <span class="id" title="var">T</span>) (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a id=":stlc::x_x" class="idref" href="#:stlc::x_x"><span class="id" title="notation">&quot;</span></a>x y" := (<a class="idref" href="lec_13_norm.html#tm_app"><span class="id" title="constructor">tm_app</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 1, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a id="c7ca0fe7e4f2c0ef6d6958a5dc4283b7" class="idref" href="#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">&quot;</span></a>\ x : t , y" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="lec_13_norm.html#tm_abs"><span class="id" title="constructor">tm_abs</span></a> <span class="id" title="var">x</span> <span class="id" title="var">t</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 90, <span class="id" title="var">x</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">y</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="lec_13_norm.html#tm_var"><span class="id" title="constructor">tm_var</span></a> <a class="idref" href="lec_13_norm.html#tm_var"><span class="id" title="constructor">:</span></a> <a class="idref" href="lec_13_norm.html#tm_var"><span class="id" title="constructor">string</span></a> <a class="idref" href="lec_13_norm.html#tm_var"><span class="id" title="constructor">&gt;-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm_var"><span class="id" title="constructor">tm</span></a>.<br/>
<span class="id" title="keyword">Notation</span> <a id="45164e50103cb4f5a6f30f892835b135" class="idref" href="#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">&quot;</span></a>{ x }" := <span class="id" title="var">x</span> (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 1, <span class="id" title="var">x</span> <span class="id" title="keyword">constr</span>).<br/>
<span class="id" title="keyword">Notation</span> <a id=":stlc::'Bool'" class="idref" href="#:stlc::'Bool'"><span class="id" title="notation">&quot;</span></a>'Bool'" := <a class="idref" href="lec_13_norm.html#Ty_Bool"><span class="id" title="constructor">Ty_Bool</span></a> (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0).<br/>
<span class="id" title="keyword">Notation</span> <a id=":stlc::'if'_x_'then'_x_'else'_x" class="idref" href="#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">&quot;</span></a>'if' x 'then' y 'else' z" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="lec_13_norm.html#tm_if"><span class="id" title="constructor">tm_if</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 89,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">y</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">z</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a id=":::'true'" class="idref" href="#:::'true'"><span class="id" title="notation">&quot;</span></a>'true'" := <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 1).<br/>
<span class="id" title="keyword">Notation</span> <a id=":stlc::'true'" class="idref" href="#:stlc::'true'"><span class="id" title="notation">&quot;</span></a>'true'" := <a class="idref" href="lec_13_norm.html#tm_true"><span class="id" title="constructor">tm_true</span></a> (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0).<br/>
<span class="id" title="keyword">Notation</span> <a id=":::'false'" class="idref" href="#:::'false'"><span class="id" title="notation">&quot;</span></a>'false'" := <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 1).<br/>
<span class="id" title="keyword">Notation</span> <a id=":stlc::'false'" class="idref" href="#:stlc::'false'"><span class="id" title="notation">&quot;</span></a>'false'" := <a class="idref" href="lec_13_norm.html#tm_false"><span class="id" title="constructor">tm_false</span></a> (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0).<br/>

<br/>
</div>

<div class="doc">
<a id="lab9"></a><h3 class="section">Substitution</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'[' x ':=' s ']' t" (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="var">x</span> <span class="id" title="keyword">constr</span>).<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="subst" class="idref" href="#subst"><span class="id" title="definition">subst</span></a> (<a id="x:5" class="idref" href="#x:5"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<a id="s:6" class="idref" href="#s:6"><span class="id" title="binder">s</span></a> : <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a>) (<a id="t:7" class="idref" href="#t:7"><span class="id" title="binder">t</span></a> : <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="lec_13_norm.html#t:7"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="lec_13_norm.html#tm_var"><span class="id" title="constructor">tm_var</span></a> <span class="id" title="var">y</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="definition">eqb_string</span> <a class="idref" href="lec_13_norm.html#x:5"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">then</span> <a class="idref" href="lec_13_norm.html#s:6"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="lec_13_norm.html#t:7"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a> <span class="id" title="var">y</span> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a> <span class="id" title="var">T</span><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <span class="id" title="var">t1</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="definition">eqb_string</span> <a class="idref" href="lec_13_norm.html#x:5"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">then</span> <a class="idref" href="lec_13_norm.html#t:7"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a><span class="id" title="var">y</span><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a><span class="id" title="var">T</span><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#s:6"><span class="id" title="variable">s</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a> <span class="id" title="var">t1</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><span class="id" title="var">t1</span> <span class="id" title="var">t2</span><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#s:6"><span class="id" title="variable">s</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><span class="id" title="var">t1</span><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#s:6"><span class="id" title="variable">s</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><span class="id" title="var">t2</span><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <span class="id" title="var">t1</span> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="var">t2</span> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="var">t3</span><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#s:6"><span class="id" title="variable">s</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a> <span class="id" title="var">t1</span><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#s:6"><span class="id" title="variable">s</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a> <span class="id" title="var">t2</span><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#s:6"><span class="id" title="variable">s</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a> <span class="id" title="var">t3</span><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">where</span> <a id="83dbd6b289334c93dbc0440277d51136" class="idref" href="#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">&quot;</span></a>'[' x ':=' s ']' t" := (<a class="idref" href="lec_13_norm.html#subst:8"><span class="id" title="definition">subst</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab10"></a><h3 class="section">Values</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="value" class="idref" href="#value"><span class="id" title="inductive">value</span></a> : <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a id="v_abs" class="idref" href="#v_abs"><span class="id" title="constructor">v_abs</span></a> : <span class="id" title="keyword">forall</span> <a id="x:12" class="idref" href="#x:12"><span class="id" title="binder">x</span></a> <a id="T2:13" class="idref" href="#T2:13"><span class="id" title="binder">T2</span></a> <a id="t1:14" class="idref" href="#t1:14"><span class="id" title="binder">t1</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value:10"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#x:12"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a><a class="idref" href="lec_13_norm.html#T2:13"><span class="id" title="variable">T2</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#t1:14"><span class="id" title="variable">t1</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>                <span class="comment">(*&nbsp;\x:T2,&nbsp;t1&nbsp;&nbsp;*)</span><br/>
| <a id="v_true" class="idref" href="#v_true"><span class="id" title="constructor">v_true</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value:10"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>                       <span class="comment">(*&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
| <a id="v_false" class="idref" href="#v_false"><span class="id" title="constructor">v_false</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value:10"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>                      <span class="comment">(*&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="lec_13_norm.html#value"><span class="id" title="inductive">value</span></a> : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab11"></a><h3 class="section">Small-Step Call-By-Value Semantics</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;t '--&gt;' t'" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/>
<span class="id" title="keyword">Inductive</span> <a id="step" class="idref" href="#step"><span class="id" title="inductive">step</span></a> : <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a id="ST_AppAbs" class="idref" href="#ST_AppAbs"><span class="id" title="constructor">ST_AppAbs</span></a> : <span class="id" title="keyword">forall</span> <a id="x:17" class="idref" href="#x:17"><span class="id" title="binder">x</span></a> <a id="T2:18" class="idref" href="#T2:18"><span class="id" title="binder">T2</span></a> <a id="t1:19" class="idref" href="#t1:19"><span class="id" title="binder">t1</span></a> <a id="v2:20" class="idref" href="#v2:20"><span class="id" title="binder">v2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#v2:20"><span class="id" title="variable">v2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#x:17"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a><a class="idref" href="lec_13_norm.html#T2:18"><span class="id" title="variable">T2</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#t1:19"><span class="id" title="variable">t1</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#v2:20"><span class="id" title="variable">v2</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:17"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v2:20"><span class="id" title="variable">v2</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t1:19"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
| <a id="ST_App1" class="idref" href="#ST_App1"><span class="id" title="constructor">ST_App1</span></a> : <span class="id" title="keyword">forall</span> <a id="t1:21" class="idref" href="#t1:21"><span class="id" title="binder">t1</span></a> <a id="t1':22" class="idref" href="#t1':22"><span class="id" title="binder">t1'</span></a> <a id="t2:23" class="idref" href="#t2:23"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#t1:21"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t1':22"><span class="id" title="variable">t1'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#t1:21"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#t2:23"><span class="id" title="variable">t2</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#t1':22"><span class="id" title="variable">t1'</span></a> <a class="idref" href="lec_13_norm.html#t2:23"><span class="id" title="variable">t2</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
| <a id="ST_App2" class="idref" href="#ST_App2"><span class="id" title="constructor">ST_App2</span></a> : <span class="id" title="keyword">forall</span> <a id="v1:24" class="idref" href="#v1:24"><span class="id" title="binder">v1</span></a> <a id="t2:25" class="idref" href="#t2:25"><span class="id" title="binder">t2</span></a> <a id="t2':26" class="idref" href="#t2':26"><span class="id" title="binder">t2'</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#v1:24"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#t2:25"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t2':26"><span class="id" title="variable">t2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#v1:24"><span class="id" title="variable">v1</span></a> <a class="idref" href="lec_13_norm.html#t2:25"><span class="id" title="variable">t2</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#v1:24"><span class="id" title="variable">v1</span></a> <a class="idref" href="lec_13_norm.html#t2':26"><span class="id" title="variable">t2'</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
| <a id="ST_IfTrue" class="idref" href="#ST_IfTrue"><span class="id" title="constructor">ST_IfTrue</span></a> : <span class="id" title="keyword">forall</span> <a id="t1:27" class="idref" href="#t1:27"><span class="id" title="binder">t1</span></a> <a id="t2:28" class="idref" href="#t2:28"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t1:27"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t2:28"><span class="id" title="variable">t2</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t1:27"><span class="id" title="variable">t1</span></a><br/>
| <a id="ST_IfFalse" class="idref" href="#ST_IfFalse"><span class="id" title="constructor">ST_IfFalse</span></a> : <span class="id" title="keyword">forall</span> <a id="t1:29" class="idref" href="#t1:29"><span class="id" title="binder">t1</span></a> <a id="t2:30" class="idref" href="#t2:30"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'false'"><span class="id" title="notation">false</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t1:29"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t2:30"><span class="id" title="variable">t2</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t2:30"><span class="id" title="variable">t2</span></a><br/>
| <a id="ST_If" class="idref" href="#ST_If"><span class="id" title="constructor">ST_If</span></a> : <span class="id" title="keyword">forall</span> <a id="t1:31" class="idref" href="#t1:31"><span class="id" title="binder">t1</span></a> <a id="t1':32" class="idref" href="#t1':32"><span class="id" title="binder">t1'</span></a> <a id="t2:33" class="idref" href="#t2:33"><span class="id" title="binder">t2</span></a> <a id="t3:34" class="idref" href="#t3:34"><span class="id" title="binder">t3</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#t1:31"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t1':32"><span class="id" title="variable">t1'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#t1:31"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t2:33"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t3:34"><span class="id" title="variable">t3</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#t1':32"><span class="id" title="variable">t1'</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t2:33"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t3:34"><span class="id" title="variable">t3</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
<br/>
<span class="id" title="keyword">where</span> <a id=":::x_'--&gt;'_x" class="idref" href="#:::x_'--&gt;'_x"><span class="id" title="notation">&quot;</span></a>t '--&gt;' t'" := (<a class="idref" href="lec_13_norm.html#step:16"><span class="id" title="inductive">step</span></a> <span class="id" title="var">t</span> <span class="id" title="var">t'</span>).<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="lec_13_norm.html#step"><span class="id" title="inductive">step</span></a> : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab12"></a><h3 class="section">Multi-Step Reduction</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a id="multistep" class="idref" href="#multistep"><span class="id" title="abbreviation">multistep</span></a> := (<span class="id" title="inductive">multi</span> <a class="idref" href="lec_13_norm.html#step"><span class="id" title="inductive">step</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="a781e4b1e2c022f0326182a9bd099911" class="idref" href="#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">&quot;</span></a>t1 '--&gt;*' t2" := (<a class="idref" href="lec_13_norm.html#multistep"><span class="id" title="abbreviation">multistep</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/>

<br/>
</div>

<div class="doc">
<a id="lab13"></a><h3 class="section">Normal Forms</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="definition">normal_form</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="step_normal_form" class="idref" href="#step_normal_form"><span class="id" title="abbreviation">step_normal_form</span></a> := (<span class="id" title="definition">normal_form</span> <a class="idref" href="lec_13_norm.html#step"><span class="id" title="inductive">step</span></a>).<br/>

<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> values cannot be reduced.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="value__normal" class="idref" href="#value__normal"><span class="id" title="lemma">value__normal</span></a> : <span class="id" title="keyword">forall</span> <a id="t:35" class="idref" href="#t:35"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#t:35"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#step_normal_form"><span class="id" title="abbreviation">step_normal_form</span></a> <a class="idref" href="lec_13_norm.html#t:35"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">intros</span> [<span class="id" title="var">t'</span> <span class="id" title="var">ST</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">ST</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">value__normal</span> : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab14"></a><h3 class="section">Small-step reductoin is deterministic</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="deterministic" class="idref" href="#deterministic"><span class="id" title="definition">deterministic</span></a> {<a id="X:36" class="idref" href="#X:36"><span class="id" title="binder">X</span></a> : <span class="id" title="keyword">Type</span>} (<a id="R:37" class="idref" href="#R:37"><span class="id" title="binder">R</span></a> : <span class="id" title="definition">relation</span> <a class="idref" href="lec_13_norm.html#X:36"><span class="id" title="variable">X</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="x:38" class="idref" href="#x:38"><span class="id" title="binder">x</span></a> <a id="y1:39" class="idref" href="#y1:39"><span class="id" title="binder">y1</span></a> <a id="y2:40" class="idref" href="#y2:40"><span class="id" title="binder">y2</span></a> : <a class="idref" href="lec_13_norm.html#X:36"><span class="id" title="variable">X</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R:37"><span class="id" title="variable">R</span></a> <a class="idref" href="lec_13_norm.html#x:38"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#y1:39"><span class="id" title="variable">y1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R:37"><span class="id" title="variable">R</span></a> <a class="idref" href="lec_13_norm.html#x:38"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#y2:40"><span class="id" title="variable">y2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#y1:39"><span class="id" title="variable">y1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#y2:40"><span class="id" title="variable">y2</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="step_deterministic" class="idref" href="#step_deterministic"><span class="id" title="lemma">step_deterministic</span></a> :<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#deterministic"><span class="id" title="definition">deterministic</span></a> <a class="idref" href="lec_13_norm.html#step"><span class="id" title="inductive">step</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#deterministic"><span class="id" title="definition">deterministic</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">t''</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">E1</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">t''</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;ST_AppAbs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">exfalso</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#value__normal"><span class="id" title="lemma">value__normal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;ST_App1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">exfalso</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#value__normal"><span class="id" title="lemma">value__normal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;ST_App2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">exfalso</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#value__normal"><span class="id" title="lemma">value__normal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">exfalso</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#value__normal"><span class="id" title="lemma">value__normal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;ST_IfTrue&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;ST_IfFalse&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;ST_If&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab15"></a><h3 class="section">Typing Contexts</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="context" class="idref" href="#context"><span class="id" title="definition">context</span></a> := <span class="id" title="definition">partial_map</span> <a class="idref" href="lec_13_norm.html#ty"><span class="id" title="inductive">ty</span></a>.<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;Gamma '' t '\in' T" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span>, <span class="id" title="var">T</span> <span class="id" title="var">custom</span> <span class="id" title="var">stlc</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0).<br/>

<br/>
</div>

<div class="doc">
<a id="lab16"></a><h3 class="section">Typing Relation</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="has_type" class="idref" href="#has_type"><span class="id" title="inductive">has_type</span></a> : <a class="idref" href="lec_13_norm.html#context"><span class="id" title="definition">context</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#ty"><span class="id" title="inductive">ty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a id="T_Var" class="idref" href="#T_Var"><span class="id" title="constructor">T_Var</span></a> : <span class="id" title="keyword">forall</span> <a id="Gamma:43" class="idref" href="#Gamma:43"><span class="id" title="binder">Gamma</span></a> <a id="x:44" class="idref" href="#x:44"><span class="id" title="binder">x</span></a> <a id="T1:45" class="idref" href="#T1:45"><span class="id" title="binder">T1</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:43"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#x:44"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="lec_13_norm.html#T1:45"><span class="id" title="variable">T1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:43"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#x:44"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T1:45"><span class="id" title="variable">T1</span></a><br/>
| <a id="T_Abs" class="idref" href="#T_Abs"><span class="id" title="constructor">T_Abs</span></a> : <span class="id" title="keyword">forall</span> <a id="Gamma:46" class="idref" href="#Gamma:46"><span class="id" title="binder">Gamma</span></a> <a id="x:47" class="idref" href="#x:47"><span class="id" title="binder">x</span></a> <a id="T1:48" class="idref" href="#T1:48"><span class="id" title="binder">T1</span></a> <a id="T2:49" class="idref" href="#T2:49"><span class="id" title="binder">T2</span></a> <a id="t1:50" class="idref" href="#t1:50"><span class="id" title="binder">t1</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#x:47"><span class="id" title="variable">x</span></a> <span class="id" title="notation">|-&gt;</span> <a class="idref" href="lec_13_norm.html#T2:49"><span class="id" title="variable">T2</span></a> <span class="id" title="notation">;</span> <a class="idref" href="lec_13_norm.html#Gamma:46"><span class="id" title="variable">Gamma</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t1:50"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T1:48"><span class="id" title="variable">T1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:46"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#x:47"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a><a class="idref" href="lec_13_norm.html#T2:49"><span class="id" title="variable">T2</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#t1:50"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#T2:49"><span class="id" title="variable">T2</span></a> <a class="idref" href="lec_13_norm.html#:stlc::x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#T1:48"><span class="id" title="variable">T1</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a><br/>
| <a id="T_App" class="idref" href="#T_App"><span class="id" title="constructor">T_App</span></a> : <span class="id" title="keyword">forall</span> <a id="T1:51" class="idref" href="#T1:51"><span class="id" title="binder">T1</span></a> <a id="T2:52" class="idref" href="#T2:52"><span class="id" title="binder">T2</span></a> <a id="Gamma:53" class="idref" href="#Gamma:53"><span class="id" title="binder">Gamma</span></a> <a id="t1:54" class="idref" href="#t1:54"><span class="id" title="binder">t1</span></a> <a id="t2:55" class="idref" href="#t2:55"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:53"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t1:54"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#T2:52"><span class="id" title="variable">T2</span></a> <a class="idref" href="lec_13_norm.html#:stlc::x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#T1:51"><span class="id" title="variable">T1</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:53"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t2:55"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T2:52"><span class="id" title="variable">T2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:53"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t1:54"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#t2:55"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T1:51"><span class="id" title="variable">T1</span></a><br/>
| <a id="T_True" class="idref" href="#T_True"><span class="id" title="constructor">T_True</span></a> : <span class="id" title="keyword">forall</span> <a id="Gamma:56" class="idref" href="#Gamma:56"><span class="id" title="binder">Gamma</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:56"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'Bool'"><span class="id" title="notation">Bool</span></a><br/>
| <a id="T_False" class="idref" href="#T_False"><span class="id" title="constructor">T_False</span></a> : <span class="id" title="keyword">forall</span> <a id="Gamma:57" class="idref" href="#Gamma:57"><span class="id" title="binder">Gamma</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:57"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#:stlc::'false'"><span class="id" title="notation">false</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'Bool'"><span class="id" title="notation">Bool</span></a><br/>
| <a id="T_If" class="idref" href="#T_If"><span class="id" title="constructor">T_If</span></a> : <span class="id" title="keyword">forall</span> <a id="t1:58" class="idref" href="#t1:58"><span class="id" title="binder">t1</span></a> <a id="t2:59" class="idref" href="#t2:59"><span class="id" title="binder">t2</span></a> <a id="t3:60" class="idref" href="#t3:60"><span class="id" title="binder">t3</span></a> <a id="T1:61" class="idref" href="#T1:61"><span class="id" title="binder">T1</span></a> <a id="Gamma:62" class="idref" href="#Gamma:62"><span class="id" title="binder">Gamma</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:62"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t1:58"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'Bool'"><span class="id" title="notation">Bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:62"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t2:59"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T1:61"><span class="id" title="variable">T1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:62"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t3:60"><span class="id" title="variable">t3</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T1:61"><span class="id" title="variable">T1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:62"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#t1:58"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t2:59"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t3:60"><span class="id" title="variable">t3</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T1:61"><span class="id" title="variable">T1</span></a><br/>
<span class="id" title="keyword">where</span> <a id="aa8312987d2180c84572f43708410ddc" class="idref" href="#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">&quot;</span></a>Gamma '' t '\in' T" := (<a class="idref" href="lec_13_norm.html#has_type:42"><span class="id" title="inductive">has_type</span></a> <span class="id" title="var">Gamma</span> <span class="id" title="var">t</span> <span class="id" title="var">T</span>).<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="lec_13_norm.html#has_type"><span class="id" title="inductive">has_type</span></a> : <span class="id" title="var">core</span>.<br/>
<span class="id" title="keyword">Hint Extern</span> 2 (<a class="idref" href="lec_13_norm.html#has_type"><span class="id" title="inductive">has_type</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#app"><span class="id" title="definition">app</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#T_App"><span class="id" title="constructor">T_App</span></a>; <span class="id" title="tactic">auto</span> : <span class="id" title="var">core</span>.<br/>
<span class="id" title="keyword">Hint Extern</span> 2 (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">compute</span>; <span class="id" title="tactic">reflexivity</span> : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab17"></a><h2 class="section">Proof of preservation recap</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> As a reminder, we needed several lemmas before we could prove
     preservation: taking a step preserves the type of a term.

</li>
<li> We needed a weakening lemma and a substitution lemma.

</li>
</ul>

<div class="paragraph"> </div>

<a id="lab18"></a><h3 class="section">Weakening</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We can always make t well-typed in a larger '.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="weakening" class="idref" href="#weakening"><span class="id" title="lemma">weakening</span></a> : <span class="id" title="keyword">forall</span> <a id="Gamma:63" class="idref" href="#Gamma:63"><span class="id" title="binder">Gamma</span></a> <a id="Gamma':64" class="idref" href="#Gamma':64"><span class="id" title="binder">Gamma'</span></a> <a id="t:65" class="idref" href="#t:65"><span class="id" title="binder">t</span></a> <a id="T:66" class="idref" href="#T:66"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="definition">inclusion</span> <a class="idref" href="lec_13_norm.html#Gamma:63"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#Gamma':64"><span class="id" title="variable">Gamma'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:63"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:65"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:66"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma':64"><span class="id" title="variable">Gamma'</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:65"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:66"><span class="id" title="variable">T</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;typing&nbsp;derivation&nbsp;of&nbsp;&nbsp;&nbsp;t&nbsp;:&nbsp;T.<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Gamma</span> <span class="id" title="var">Gamma'</span> <span class="id" title="var">t</span> <span class="id" title="var">T</span> <span class="id" title="var">H</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">Gamma'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">inclusion_update</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Corollary</span> <a id="weakening_empty" class="idref" href="#weakening_empty"><span class="id" title="lemma">weakening_empty</span></a> : <span class="id" title="keyword">forall</span> <a id="Gamma:67" class="idref" href="#Gamma:67"><span class="id" title="binder">Gamma</span></a> <a id="t:68" class="idref" href="#t:68"><span class="id" title="binder">t</span></a> <a id="T:69" class="idref" href="#T:69"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:68"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:69"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:67"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:68"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:69"><span class="id" title="variable">T</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Gamma</span> <span class="id" title="var">t</span> <span class="id" title="var">T</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#weakening"><span class="id" title="lemma">weakening</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab19"></a><h3 class="section">Substitution</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Substitution of a closed term preserves typing.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="substitution_preserves_typing" class="idref" href="#substitution_preserves_typing"><span class="id" title="lemma">substitution_preserves_typing</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="Gamma:70" class="idref" href="#Gamma:70"><span class="id" title="binder">Gamma</span></a> <a id="x:71" class="idref" href="#x:71"><span class="id" title="binder">x</span></a> <a id="U:72" class="idref" href="#U:72"><span class="id" title="binder">U</span></a> <a id="t:73" class="idref" href="#t:73"><span class="id" title="binder">t</span></a> <a id="v:74" class="idref" href="#v:74"><span class="id" title="binder">v</span></a> <a id="T:75" class="idref" href="#T:75"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#x:71"><span class="id" title="variable">x</span></a> <span class="id" title="notation">|-&gt;</span> <a class="idref" href="lec_13_norm.html#U:72"><span class="id" title="variable">U</span></a> <span class="id" title="notation">;</span> <a class="idref" href="lec_13_norm.html#Gamma:70"><span class="id" title="variable">Gamma</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:73"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:75"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#v:74"><span class="id" title="variable">v</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#U:72"><span class="id" title="variable">U</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:70"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:71"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v:74"><span class="id" title="variable">v</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t:73"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:75"><span class="id" title="variable">T</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Gamma</span> <span class="id" title="var">x</span> <span class="id" title="var">U</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span> <span class="id" title="var">T</span> <span class="id" title="var">Ht</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">Gamma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">T</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;structure&nbsp;of&nbsp;terms.&nbsp;(Why?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;only&nbsp;two&nbsp;cases&nbsp;that&nbsp;are&nbsp;not&nbsp;straightforward&nbsp;are&nbsp;variables&nbsp;and&nbsp;abstraction.<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">Gamma</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;in&nbsp;each&nbsp;case,&nbsp;we'll&nbsp;want&nbsp;to&nbsp;get&nbsp;at&nbsp;the&nbsp;derivation&nbsp;of&nbsp;H&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">s</span> <span class="id" title="var">into</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>); <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x=y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">update_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#weakening_empty"><span class="id" title="lemma">weakening_empty</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x&lt;&gt;y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#T_Var"><span class="id" title="constructor">T_Var</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">update_neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">s</span> <span class="id" title="var">into</span> <span class="id" title="var">y</span>, <span class="id" title="var">t</span> <span class="id" title="var">into</span> <span class="id" title="var">S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>); <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#T_Abs"><span class="id" title="constructor">T_Abs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x=y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">update_shadow</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x&lt;&gt;y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">update_permute</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="preservation" class="idref" href="#preservation"><span class="id" title="lemma">preservation</span></a> : <span class="id" title="keyword">forall</span> <a id="t:76" class="idref" href="#t:76"><span class="id" title="binder">t</span></a> <a id="t':77" class="idref" href="#t':77"><span class="id" title="binder">t'</span></a> <a id="T:78" class="idref" href="#T:78"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:76"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:78"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#t:76"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t':77"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t':77"><span class="id" title="variable">t'</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:78"><span class="id" title="variable">T</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> <span class="id" title="var">T</span> <span class="id" title="var">HT</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="definition">empty</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Gamma</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof:<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;derivation&nbsp;of&nbsp;empty&nbsp;&nbsp;t&nbsp;:&nbsp;T.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;only&nbsp;non-trivial&nbsp;case&nbsp;is&nbsp;the&nbsp;application&nbsp;case.<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">HT</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">t'</span> <span class="id" title="var">HE</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">HE</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HT</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;T_App&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HE</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;ST_AppAbs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#substitution_preserves_typing"><span class="id" title="lemma">substitution_preserves_typing</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">T2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HT1</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab20"></a><h2 class="section">Strong Normalization of Simply-Typed Lambda Calculus</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Our goal is to prove strong normalization (SN) of STLC.

</li>
<li> Informally, this means that every term reduces to a value.

</li>
</ul>

<div class="paragraph"> </div>

 
<div class="paragraph"> </div>

<a id="lab21"></a><h3 class="section">Halts or Strong Normalization</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="halts" class="idref" href="#halts"><span class="id" title="definition">halts</span></a> (<a id="t:79" class="idref" href="#t:79"><span class="id" title="binder">t</span></a>:<a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="t':80" class="idref" href="#t':80"><span class="id" title="binder">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#t:79"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#t':80"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="lec_13_norm.html#value"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#t':80"><span class="id" title="variable">t'</span></a>.<br/>

<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> Clearly all values should halt.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="value_halts" class="idref" href="#value_halts"><span class="id" title="lemma">value_halts</span></a> : <span class="id" title="keyword">forall</span> <a id="v:81" class="idref" href="#v:81"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#v:81"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a> <a class="idref" href="lec_13_norm.html#v:81"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="constructor">multi_refl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab22"></a><h3 class="section">Ordinary Induction Fails</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> SN is not true of many languages such as those with recursion.

</li>
<li> Nevertheless, it is still useful to study the proof of SN of STLC
     because all the techniques we've seen so far:
<ul class="doclist">
<li> induction on terms

</li>
<li> induction on types

</li>
<li> induction on operational semantics

</li>
<li> induction on typing derivation

</li>
</ul>
     will fail.

</li>
</ul>
 
<div class="paragraph"> </div>

<a id="lab23"></a><h3 class="section">Why do we need logical relations? Normalization Attempt</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="normalization_attempt" class="idref" href="#normalization_attempt"><span class="id" title="lemma">normalization_attempt</span></a>: <span class="id" title="keyword">forall</span> <a id="t:82" class="idref" href="#t:82"><span class="id" title="binder">t</span></a> <a id="T:83" class="idref" href="#T:83"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:82"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:83"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a> <a class="idref" href="lec_13_norm.html#t:82"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">T</span> <span class="id" title="var">Htyp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="definition">empty</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Gamma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Htyp</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Horray!<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ </div>

<div class="doc">
case T = t1 t2 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHtyp2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHtyp1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oh&nbsp;no,&nbsp;our&nbsp;inductive&nbsp;hypothesis&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;be<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strong&nbsp;enough&nbsp;here.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Can&nbsp;you&nbsp;think&nbsp;of&nbsp;an&nbsp;example?<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\x.&nbsp;x&nbsp;x)&nbsp;(\x.&nbsp;x&nbsp;x)&nbsp;(call-by-name)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHtyp3</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHtyp2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHtyp1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Can&nbsp;use&nbsp;type-soundness&nbsp;here&nbsp;and&nbsp;other&nbsp;similar&nbsp;cases.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab24"></a><h3 class="section">What's the fix?</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> To prove SN, we will need to introduce a proof technique called
      <i>logical relations</i> (technically we'll only need <i>logical predicates</i>).

</li>
<li> Logical relations are an extremely powerful proof technique.

</li>
<li> Before we can do introduce them, we will need to take a closer look
     at free variables and closed terms. As you might have guessed from the proof
     of preservation, the entire difficulty deals with free variables and closed
     terms.

</li>
</ul>

<div class="paragraph"> </div>

 
<div class="paragraph"> </div>

<a id="lab25"></a><h3 class="section">Free Variables and Closed Terms</h3>

<div class="paragraph"> </div>

<a id="lab26"></a><h4 class="section">Free Variables</h4>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We've shown free variables as fix-points before using sets.

</li>
<li> Here we're using an inductive definition.

</li>
<li> This is a formalization choice.

</li>
<li> The advantage of using an inductive definition is that we do
      not need extra properties of sets.

</li>
<li> The disadvantage is that we cannot take advantage of computation.

</li>
</ul>

<div class="paragraph"> </div>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="appears_free_in" class="idref" href="#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
<span class="comment">(*&nbsp;pure&nbsp;STLC&nbsp;*)</span><br/>
| <a id="afi_var" class="idref" href="#afi_var"><span class="id" title="constructor">afi_var</span></a> : <span class="id" title="keyword">forall</span> (<a id="x:86" class="idref" href="#x:86"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:86"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#x:86"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
| <a id="afi_app1" class="idref" href="#afi_app1"><span class="id" title="constructor">afi_app1</span></a> : <span class="id" title="keyword">forall</span> <a id="x:87" class="idref" href="#x:87"><span class="id" title="binder">x</span></a> <a id="t1:88" class="idref" href="#t1:88"><span class="id" title="binder">t1</span></a> <a id="t2:89" class="idref" href="#t2:89"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:87"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t1:88"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:87"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#t1:88"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#t2:89"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
| <a id="afi_app2" class="idref" href="#afi_app2"><span class="id" title="constructor">afi_app2</span></a> : <span class="id" title="keyword">forall</span> <a id="x:90" class="idref" href="#x:90"><span class="id" title="binder">x</span></a> <a id="t1:91" class="idref" href="#t1:91"><span class="id" title="binder">t1</span></a> <a id="t2:92" class="idref" href="#t2:92"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:90"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t2:92"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:90"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#t1:91"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#t2:92"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
| <a id="afi_abs" class="idref" href="#afi_abs"><span class="id" title="constructor">afi_abs</span></a> : <span class="id" title="keyword">forall</span> <a id="x:93" class="idref" href="#x:93"><span class="id" title="binder">x</span></a> <a id="y:94" class="idref" href="#y:94"><span class="id" title="binder">y</span></a> <a id="T11:95" class="idref" href="#T11:95"><span class="id" title="binder">T11</span></a> <a id="t12:96" class="idref" href="#t12:96"><span class="id" title="binder">t12</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#y:94"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="lec_13_norm.html#x:93"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:93"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t12:96"><span class="id" title="variable">t12</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:93"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#y:94"><span class="id" title="variable">y</span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a> <a class="idref" href="lec_13_norm.html#T11:95"><span class="id" title="variable">T11</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#t12:96"><span class="id" title="variable">t12</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
<span class="comment">(*&nbsp;booleans&nbsp;*)</span><br/>
| <a id="afi_test0" class="idref" href="#afi_test0"><span class="id" title="constructor">afi_test0</span></a> : <span class="id" title="keyword">forall</span> <a id="x:97" class="idref" href="#x:97"><span class="id" title="binder">x</span></a> <a id="t0:98" class="idref" href="#t0:98"><span class="id" title="binder">t0</span></a> <a id="t1:99" class="idref" href="#t1:99"><span class="id" title="binder">t1</span></a> <a id="t2:100" class="idref" href="#t2:100"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:97"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t0:98"><span class="id" title="variable">t0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:97"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#t0:98"><span class="id" title="variable">t0</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t1:99"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t2:100"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
| <a id="afi_test1" class="idref" href="#afi_test1"><span class="id" title="constructor">afi_test1</span></a> : <span class="id" title="keyword">forall</span> <a id="x:101" class="idref" href="#x:101"><span class="id" title="binder">x</span></a> <a id="t0:102" class="idref" href="#t0:102"><span class="id" title="binder">t0</span></a> <a id="t1:103" class="idref" href="#t1:103"><span class="id" title="binder">t1</span></a> <a id="t2:104" class="idref" href="#t2:104"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:101"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t1:103"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:101"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#t0:102"><span class="id" title="variable">t0</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t1:103"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t2:104"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
| <a id="afi_test2" class="idref" href="#afi_test2"><span class="id" title="constructor">afi_test2</span></a> : <span class="id" title="keyword">forall</span> <a id="x:105" class="idref" href="#x:105"><span class="id" title="binder">x</span></a> <a id="t0:106" class="idref" href="#t0:106"><span class="id" title="binder">t0</span></a> <a id="t1:107" class="idref" href="#t1:107"><span class="id" title="binder">t1</span></a> <a id="t2:108" class="idref" href="#t2:108"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:105"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t2:108"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in:84"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:105"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#t0:106"><span class="id" title="variable">t0</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t1:107"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t2:108"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab27"></a><h4 class="section">Closed Term</h4>


<div class="paragraph"> </div>

<ul class="doclist">
<li> A closed term is one with no free variables.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="closed" class="idref" href="#closed"><span class="id" title="definition">closed</span></a> (<a id="t:109" class="idref" href="#t:109"><span class="id" title="binder">t</span></a>:<a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="x:110" class="idref" href="#x:110"><span class="id" title="binder">x</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:110"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t:109"><span class="id" title="variable">t</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab28"></a><h4 class="section">Context Invariance</h4>


<div class="paragraph"> </div>

<ul class="doclist">
<li> For those variables that are free, we require that the
     different contexts assign the same types.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="context_invariance" class="idref" href="#context_invariance"><span class="id" title="lemma">context_invariance</span></a> : <span class="id" title="keyword">forall</span> <a id="Gamma:111" class="idref" href="#Gamma:111"><span class="id" title="binder">Gamma</span></a> <a id="Gamma':112" class="idref" href="#Gamma':112"><span class="id" title="binder">Gamma'</span></a> <a id="t:113" class="idref" href="#t:113"><span class="id" title="binder">t</span></a> <a id="S:114" class="idref" href="#S:114"><span class="id" title="binder">S</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:111"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:113"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#S:114"><span class="id" title="variable">S</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="x:115" class="idref" href="#x:115"><span class="id" title="binder">x</span></a>, <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:115"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t:113"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#Gamma:111"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#x:115"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#Gamma':112"><span class="id" title="variable">Gamma'</span></a> <a class="idref" href="lec_13_norm.html#x:115"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma':112"><span class="id" title="variable">Gamma'</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:113"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#S:114"><span class="id" title="variable">S</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Gamma</span> <span class="id" title="var">Gamma'</span> <span class="id" title="var">t</span> <span class="id" title="var">S</span> <span class="id" title="var">Htyp</span> <span class="id" title="var">HE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">Gamma'</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof:<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;derivation&nbsp;of&nbsp;&nbsp;&nbsp;t&nbsp;:&nbsp;T.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;only&nbsp;non-trivial&nbsp;case&nbsp;is&nbsp;the&nbsp;abstraction&nbsp;case.<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Htyp</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">eauto</span> 12.<br/>
&nbsp;&nbsp;{ <span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;t&nbsp;=&nbsp;x&nbsp;(automation&nbsp;fails&nbsp;in&nbsp;this&nbsp;case):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;suffices&nbsp;to&nbsp;show&nbsp;'(x)&nbsp;=&nbsp;T&nbsp;by&nbsp;T_Var.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;follows&nbsp;by&nbsp;our&nbsp;assumption&nbsp;HE.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#T_Var"><span class="id" title="constructor">T_Var</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HE</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;t&nbsp;=&nbsp;\x:&nbsp;T2,&nbsp;t1&nbsp;:<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;suffices&nbsp;to&nbsp;show&nbsp;',&nbsp;x:&nbsp;T2&nbsp;&nbsp;t1&nbsp;:&nbsp;T1&nbsp;by&nbsp;T_Abs.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;our&nbsp;inductive&nbsp;hypothesis,&nbsp;we&nbsp;can&nbsp;show<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(',&nbsp;x:&nbsp;T2)(x1)&nbsp;=&nbsp;(,&nbsp;x:&nbsp;T2)(x1)&nbsp;whenever&nbsp;x1&nbsp;is&nbsp;free&nbsp;in&nbsp;t1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;proceed&nbsp;by&nbsp;case&nbsp;analysis&nbsp;on&nbsp;whether&nbsp;x&nbsp;=&nbsp;x1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;x&nbsp;=&nbsp;x1:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;x&nbsp;=&nbsp;x1,&nbsp;then&nbsp;we&nbsp;need&nbsp;to&nbsp;show&nbsp;that&nbsp;T2&nbsp;=&nbsp;T2&nbsp;(by&nbsp;context&nbsp;lookup),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;reflexively&nbsp;follows.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;x&nbsp;!=&nbsp;x1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;x&nbsp;!=&nbsp;x1,&nbsp;then&nbsp;we&nbsp;need&nbsp;to&nbsp;show&nbsp;that&nbsp;'(x1)&nbsp;=&nbsp;(x1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;HE,&nbsp;we&nbsp;can&nbsp;equivalently&nbsp;show&nbsp;that&nbsp;x1&nbsp;is&nbsp;free&nbsp;in&nbsp;\x:&nbsp;T2,&nbsp;t1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;follows&nbsp;by&nbsp;definition&nbsp;of&nbsp;free&nbsp;variables&nbsp;for&nbsp;abstraction.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#T_Abs"><span class="id" title="constructor">T_Abs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHHtyp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">Hafi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">x1</span>); <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">update_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">update_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">update_neq</span>; [| <span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">update_neq</span>; [| <span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#afi_abs"><span class="id" title="constructor">afi_abs</span></a>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab29"></a><h4 class="section">Free in Context</h4>


<div class="paragraph"> </div>

<ul class="doclist">
<li> For those variables that are free, we need to say that
     context lookup is successful.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="free_in_context" class="idref" href="#free_in_context"><span class="id" title="lemma">free_in_context</span></a> : <span class="id" title="keyword">forall</span> <a id="x:116" class="idref" href="#x:116"><span class="id" title="binder">x</span></a> <a id="t:117" class="idref" href="#t:117"><span class="id" title="binder">t</span></a> <a id="T:118" class="idref" href="#T:118"><span class="id" title="binder">T</span></a> <a id="Gamma:119" class="idref" href="#Gamma:119"><span class="id" title="binder">Gamma</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:116"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t:117"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:119"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:117"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:118"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="T':120" class="idref" href="#T':120"><span class="id" title="binder">T'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#Gamma:119"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#x:116"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="lec_13_norm.html#T':120"><span class="id" title="variable">T'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span> <span class="id" title="var">T</span> <span class="id" title="var">Gamma</span> <span class="id" title="var">Hafi</span> <span class="id" title="var">Htyp</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;derivation&nbsp;of&nbsp;&nbsp;&nbsp;t&nbsp;:&nbsp;T.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;only&nbsp;non-trivial&nbsp;case&nbsp;is&nbsp;the&nbsp;abstraction&nbsp;case.<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Htyp</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hafi</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;t&nbsp;=&nbsp;\x0:&nbsp;T2,&nbsp;t1&nbsp;:<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;inversion&nbsp;on&nbsp;appears_free_in&nbsp;x&nbsp;t,&nbsp;the&nbsp;only&nbsp;non-trivial&nbsp;case&nbsp;is<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;x0&nbsp;!=&nbsp;x.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;this&nbsp;case,&nbsp;it&nbsp;suffices&nbsp;to&nbsp;show&nbsp;that&nbsp;there&nbsp;exists&nbsp;some&nbsp;T'&nbsp;such&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x)&nbsp;=&nbsp;T'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;our&nbsp;inductive&nbsp;hypothesis,&nbsp;we&nbsp;have&nbsp;that&nbsp;there&nbsp;exists&nbsp;some&nbsp;T'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;such&nbsp;that&nbsp;(,&nbsp;x0:&nbsp;T2)(x)&nbsp;=&nbsp;T'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;x0&nbsp;!=&nbsp;x,&nbsp;we&nbsp;have&nbsp;that&nbsp;(x)&nbsp;=&nbsp;T',&nbsp;so&nbsp;we&nbsp;have&nbsp;found&nbsp;such&nbsp;a&nbsp;T'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHHtyp</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">T'</span> <span class="id" title="var">Hctx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">T'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">update</span>, <span class="id" title="definition">t_update</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">false_eqb_string</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hctx</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> A term typeable-in an empty context is closed.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Corollary</span> <a id="typable_empty__closed" class="idref" href="#typable_empty__closed"><span class="id" title="lemma">typable_empty__closed</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="t:121" class="idref" href="#t:121"><span class="id" title="binder">t</span></a> <a id="T:122" class="idref" href="#T:122"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:121"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:122"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <a class="idref" href="lec_13_norm.html#t:121"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="lec_13_norm.html#free_in_context"><span class="id" title="lemma">free_in_context</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">T'</span> <span class="id" title="var">C</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span> <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab30"></a><h2 class="section">Logical Relations</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Now that we have defined close terms we can finally define
     logical relations.

</li>
<li> We will define the relation R by structural induction on types.

</li>
</ul>
 
</div>
<div class="code">

<br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;R_{Bool}(t)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;empty&nbsp;&nbsp;t:&nbsp;Bool&nbsp;&nbsp;v.&nbsp;t&nbsp;--&gt;*&nbsp;v<br/>
<br/>
&nbsp;&nbsp;&nbsp;R_{T1&nbsp;-&gt;&nbsp;T2}(t)&nbsp;:=&nbsp;empty&nbsp;&nbsp;t:&nbsp;T1&nbsp;-&gt;&nbsp;T2&nbsp;&nbsp;v.&nbsp;t&nbsp;-&gt;*&nbsp;v&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.&nbsp;R_{T1}(s)&nbsp;-&gt;&nbsp;R_{T2}(t&nbsp;s)<br/>
<br/>
*)</span><br/>
<span class="id" title="keyword">Fixpoint</span> <a id="R" class="idref" href="#R"><span class="id" title="definition">R</span></a> (<a id="T:123" class="idref" href="#T:123"><span class="id" title="binder">T</span></a>:<a class="idref" href="lec_13_norm.html#ty"><span class="id" title="inductive">ty</span></a>) (<a id="t:124" class="idref" href="#t:124"><span class="id" title="binder">t</span></a>:<a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:124"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:123"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a> <a class="idref" href="lec_13_norm.html#t:124"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="lec_13_norm.html#T:123"><span class="id" title="variable">T</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'Bool'"><span class="id" title="notation">Bool</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">T1</span> <a class="idref" href="lec_13_norm.html#:stlc::x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">T2</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <a id="s:127" class="idref" href="#s:127"><span class="id" title="binder">s</span></a>, <a class="idref" href="lec_13_norm.html#R:125"><span class="id" title="definition">R</span></a> <span class="id" title="var">T1</span> <a class="idref" href="lec_13_norm.html#s:127"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#R:125"><span class="id" title="definition">R</span></a> <span class="id" title="var">T2</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="lec_13_norm.html#t:124"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#s:127"><span class="id" title="variable">s</span></a><a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab31"></a><h3 class="section">Strategy</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Once we have defined the logical relation R, we will prove strong normalization
     of STLC in two steps.

</li>
</ul>

<div class="paragraph"> </div>

   1. empty  t: T -&gt; R{T}(t)
   2. R{T}(t) -&gt; halts(t)

<div class="paragraph"> </div>

 
<div class="paragraph"> </div>

<a id="lab32"></a><h3 class="section">Step 2</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> It is trivial to show that being in the relation R implies that the
     term t halts.

</li>
<li> Indeed, we baked in that t being in R means that it must halt.

</li>
<li> We show step 2 now.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="R_halts" class="idref" href="#R_halts"><span class="id" title="lemma">R_halts</span></a> : <span class="id" title="keyword">forall</span> {<a id="T:128" class="idref" href="#T:128"><span class="id" title="binder">T</span></a>} {<a id="t:129" class="idref" href="#t:129"><span class="id" title="binder">t</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:128"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t:129"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a> <a class="idref" href="lec_13_norm.html#t:129"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">T</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> [<span class="id" title="var">H</span> <span class="id" title="var">_</span>]]; <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> Another easy lemma.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="R_typable_empty" class="idref" href="#R_typable_empty"><span class="id" title="lemma">R_typable_empty</span></a> : <span class="id" title="keyword">forall</span> {<a id="T:130" class="idref" href="#T:130"><span class="id" title="binder">T</span></a>} {<a id="t:131" class="idref" href="#t:131"><span class="id" title="binder">t</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:130"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t:131"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:131"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:130"><span class="id" title="variable">T</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">T</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span> <span class="id" title="var">_</span>]; <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab33"></a><h3 class="section">Step 1</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We now turn our attention to proving Step 1.

</li>
<li> We'll need a series of technical lemmas
      1. forwards/backwards reduction preserves R
      2. the *fundamental* lemma.

</li>
</ul>
 
<div class="paragraph"> </div>

<a id="lab34"></a><h3 class="section">Forwards and Backwards Reduction</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We first need a lemma that shows that taking a step
     preserves halting, in both directions.

</li>
</ul>
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="step_preserves_halting" class="idref" href="#step_preserves_halting"><span class="id" title="lemma">step_preserves_halting</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="t:132" class="idref" href="#t:132"><span class="id" title="binder">t</span></a> <a id="t':133" class="idref" href="#t':133"><span class="id" title="binder">t'</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#t:132"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t':133"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a> <a class="idref" href="lec_13_norm.html#t:132"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a> <a class="idref" href="lec_13_norm.html#t':133"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> <span class="id" title="var">ST</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;halts&nbsp;t&nbsp;=&gt;&nbsp;halts&nbsp;t'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">t''</span> [<span class="id" title="var">STM</span> <span class="id" title="var">V</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">STM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
         case multi_refl:         
       
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#value__normal"><span class="id" title="lemma">value__normal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">V</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
         case multi_step:

<div class="paragraph"> </div>

         This uses step_deterministic!
       
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="lec_13_norm.html#step_deterministic"><span class="id" title="lemma">step_deterministic</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ST</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;halts&nbsp;t'&nbsp;=&gt;&nbsp;halts&nbsp;t&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">t'0</span> [<span class="id" title="var">STM</span> <span class="id" title="var">V</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">t'0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab35"></a><h3 class="section">Forward Reduction preserves R</h3>

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="step_preserves_R" class="idref" href="#step_preserves_R"><span class="id" title="lemma">step_preserves_R</span></a> : <span class="id" title="keyword">forall</span> <a id="T:134" class="idref" href="#T:134"><span class="id" title="binder">T</span></a> <a id="t:135" class="idref" href="#t:135"><span class="id" title="binder">t</span></a> <a id="t':136" class="idref" href="#t':136"><span class="id" title="binder">t'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#t:135"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t':136"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:134"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t:135"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:134"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t':136"><span class="id" title="variable">t'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Question:&nbsp;what&nbsp;do&nbsp;we&nbsp;do&nbsp;induction&nbsp;on?&nbsp;*)</span><br/>

<br/>

<br/>

<br/>
&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">T</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> <span class="id" title="var">E</span> <span class="id" title="var">Rt</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a>; <span class="id" title="tactic">fold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a>; <span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Rt</span>; <span class="id" title="tactic">fold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Rt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Rt</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">typable_empty_t</span> [<span class="id" title="var">halts_t</span> <span class="id" title="var">RRt</span>]].<br/>
&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;T&nbsp;=&nbsp;Bool:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#preservation"><span class="id" title="lemma">preservation</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="lec_13_norm.html#step_preserves_halting"><span class="id" title="lemma">step_preserves_halting</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;}<br/>
&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;T&nbsp;=&nbsp;T1&nbsp;-&gt;&nbsp;T2:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#preservation"><span class="id" title="lemma">preservation</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="lec_13_norm.html#step_preserves_halting"><span class="id" title="lemma">step_preserves_halting</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHT2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#ST_App1"><span class="id" title="constructor">ST_App1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">RRt</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="multistep_preserves_R" class="idref" href="#multistep_preserves_R"><span class="id" title="lemma">multistep_preserves_R</span></a> : <span class="id" title="keyword">forall</span> <a id="T:137" class="idref" href="#T:137"><span class="id" title="binder">T</span></a> <a id="t:138" class="idref" href="#t:138"><span class="id" title="binder">t</span></a> <a id="t':139" class="idref" href="#t':139"><span class="id" title="binder">t'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#t:138"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#t':139"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:137"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t:138"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:137"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t':139"><span class="id" title="variable">t'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> <span class="id" title="var">STM</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">STM</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHSTM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#step_preserves_R"><span class="id" title="lemma">step_preserves_R</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab36"></a><h3 class="section">Backward Reduction preserves R</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> This lemma is admittedly a bit weird!?

</li>
<li> But we'll need it.

</li>
</ul>

<div class="paragraph"> </div>


</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="step_preserves_R'" class="idref" href="#step_preserves_R'"><span class="id" title="lemma">step_preserves_R'</span></a> : <span class="id" title="keyword">forall</span> <a id="T:140" class="idref" href="#T:140"><span class="id" title="binder">T</span></a> <a id="t:141" class="idref" href="#t:141"><span class="id" title="binder">t</span></a> <a id="t':142" class="idref" href="#t':142"><span class="id" title="binder">t'</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:141"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:140"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#t:141"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#:::x_'--&gt;'_x"><span class="id" title="notation">--&gt;</span></a> <a class="idref" href="lec_13_norm.html#t':142"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:140"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t':142"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:140"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t:141"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">T</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> <span class="id" title="var">HTyp</span> <span class="id" title="var">E</span> <span class="id" title="var">Rt</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a>; <span class="id" title="tactic">fold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a>; <span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Rt</span>; <span class="id" title="tactic">fold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Rt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Rt</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">typable_empty_t</span> [<span class="id" title="var">halts_t</span> <span class="id" title="var">RRt</span>]].<br/>
&nbsp;&nbsp;{ <span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;T&nbsp;=&nbsp;bool:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="lec_13_norm.html#step_preserves_halting"><span class="id" title="lemma">step_preserves_halting</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;T&nbsp;=&nbsp;T1&nbsp;-&gt;&nbsp;T2:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<a class="idref" href="lec_13_norm.html#step_preserves_halting"><span class="id" title="lemma">step_preserves_halting</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHT2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#T_App"><span class="id" title="constructor">T_App</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#R_typable_empty"><span class="id" title="lemma">R_typable_empty</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="multistep_preserves_R'" class="idref" href="#multistep_preserves_R'"><span class="id" title="lemma">multistep_preserves_R'</span></a> : <span class="id" title="keyword">forall</span> <a id="T:143" class="idref" href="#T:143"><span class="id" title="binder">T</span></a> <a id="t:144" class="idref" href="#t:144"><span class="id" title="binder">t</span></a> <a id="t':145" class="idref" href="#t':145"><span class="id" title="binder">t'</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:144"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:143"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#t:144"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#t':145"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:143"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t':145"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:143"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t:144"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> <span class="id" title="var">HT</span> <span class="id" title="var">STM</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">STM</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;multi_refl:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;multi_step:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#step_preserves_R'"><span class="id" title="lemma">step_preserves_R'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHSTM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#preservation"><span class="id" title="lemma">preservation</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab37"></a><h3 class="section">Step 1, First Attempt</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We might be tempted now to prove step 1 directly.

</li>
<li> But we'll see that we get stuck in the lambda abstraction case.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="step_1_try" class="idref" href="#step_1_try"><span class="id" title="lemma">step_1_try</span></a> : <span class="id" title="keyword">forall</span> <a id="T:146" class="idref" href="#T:146"><span class="id" title="binder">T</span></a> <a id="t:147" class="idref" href="#t:147"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:147"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:146"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:146"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t:147"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="definition">empty</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Gamma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Oh&nbsp;no,&nbsp;stuck&nbsp;here!&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHhas_type1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab38"></a><h3 class="section">The Fundamental Lemma</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Like our proof of preservation, we need a stronger lemma
     that talks about arbitrary contexts.

</li>
<li> In particular, we need to show that

<div class="paragraph"> </div>

    Fundamental Lemma:
      t: T -&gt;    -&gt; R{T}((t))

<div class="paragraph"> </div>

    where

<div class="paragraph"> </div>

    1. The environment  maps variables to terms.
    2.    means that the environment  and the context  contain the same
       variables at the appropriate types.
    3. (t) is notation for substitute all of the free-variables in t with the
       terms in .

<div class="paragraph"> </div>


</li>
<li> As you might have guessed, we need to show a lot of lemmas about
     multi-substitutions now.

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

<a id="lab39"></a><h3 class="section">Multi-substitutions</h3>

<div class="paragraph"> </div>

<a id="lab40"></a><h3 class="section">Environments </h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We will model environment's  as lists of pairs.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="env" class="idref" href="#env"><span class="id" title="definition">env</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab41"></a><h3 class="section">(t)</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We will now need to define multi-substitution.

</li>
</ul>

<div class="paragraph"> </div>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="msubst" class="idref" href="#msubst"><span class="id" title="definition">msubst</span></a> (<a id="ss:148" class="idref" href="#ss:148"><span class="id" title="binder">ss</span></a>:<a class="idref" href="lec_13_norm.html#env"><span class="id" title="definition">env</span></a>) (<a id="t:149" class="idref" href="#t:149"><span class="id" title="binder">t</span></a>:<a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="lec_13_norm.html#tm"><span class="id" title="inductive">tm</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="lec_13_norm.html#ss:148"><span class="id" title="variable">ss</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="lec_13_norm.html#t:149"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">ss'</span>) =&gt; <a class="idref" href="lec_13_norm.html#msubst:150"><span class="id" title="definition">msubst</span></a> <span class="id" title="var">ss'</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><span class="id" title="var">x</span><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><span class="id" title="var">s</span><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t:149"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab42"></a><h3 class="section">Contexts </h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We will model type contexts  as lists of pairs.

</li>
<li> Previously we used the functional dictionary.

</li>
<li> Here we use this so that we can match the structure of our environments.

</li>
</ul>

<div class="paragraph"> </div>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="tass" class="idref" href="#tass"><span class="id" title="definition">tass</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="lec_13_norm.html#ty"><span class="id" title="inductive">ty</span></a>).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="mupdate" class="idref" href="#mupdate"><span class="id" title="definition">mupdate</span></a> (<a id="Gamma:152" class="idref" href="#Gamma:152"><span class="id" title="binder">Gamma</span></a> : <a class="idref" href="lec_13_norm.html#context"><span class="id" title="definition">context</span></a>) (<a id="xts:153" class="idref" href="#xts:153"><span class="id" title="binder">xts</span></a> : <a class="idref" href="lec_13_norm.html#tass"><span class="id" title="definition">tass</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="lec_13_norm.html#xts:153"><span class="id" title="variable">xts</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="lec_13_norm.html#Gamma:152"><span class="id" title="variable">Gamma</span></a><br/>
&nbsp;&nbsp;| (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">xts'</span>) =&gt; <span class="id" title="definition">update</span> (<a class="idref" href="lec_13_norm.html#mupdate:154"><span class="id" title="definition">mupdate</span></a> <a class="idref" href="lec_13_norm.html#Gamma:152"><span class="id" title="variable">Gamma</span></a> <span class="id" title="var">xts'</span>) <span class="id" title="var">x</span> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab43"></a><h3 class="section">Some Generic Functions on List Environments</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="lookup" class="idref" href="#lookup"><span class="id" title="definition">lookup</span></a> {<a id="X:156" class="idref" href="#X:156"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Set</span>} (<a id="k:157" class="idref" href="#k:157"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<a id="l:158" class="idref" href="#l:158"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="lec_13_norm.html#X:156"><span class="id" title="variable">X</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="lec_13_norm.html#X:156"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="lec_13_norm.html#l:158"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">j</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">l'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="definition">eqb_string</span> <span class="id" title="var">j</span> <a class="idref" href="lec_13_norm.html#k:157"><span class="id" title="variable">k</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x</span> <span class="id" title="keyword">else</span> <a class="idref" href="lec_13_norm.html#lookup:159"><span class="id" title="definition">lookup</span></a> <a class="idref" href="lec_13_norm.html#k:157"><span class="id" title="variable">k</span></a> <span class="id" title="var">l'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="mupdate_lookup" class="idref" href="#mupdate_lookup"><span class="id" title="lemma">mupdate_lookup</span></a> : <span class="id" title="keyword">forall</span> (<a id="c:161" class="idref" href="#c:161"><span class="id" title="binder">c</span></a> : <a class="idref" href="lec_13_norm.html#tass"><span class="id" title="definition">tass</span></a>) (<a id="x:162" class="idref" href="#x:162"><span class="id" title="binder">x</span></a>:<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="lec_13_norm.html#x:162"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#c:161"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> (<a class="idref" href="lec_13_norm.html#mupdate"><span class="id" title="definition">mupdate</span></a> <span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#c:161"><span class="id" title="variable">c</span></a>) <a class="idref" href="lec_13_norm.html#x:162"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a>, <a class="idref" href="lec_13_norm.html#mupdate"><span class="id" title="definition">mupdate</span></a>, <span class="id" title="definition">update</span>, <span class="id" title="definition">t_update</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">eqb_string</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="drop" class="idref" href="#drop"><span class="id" title="definition">drop</span></a> {<a id="X:163" class="idref" href="#X:163"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Set</span>} (<a id="n:164" class="idref" href="#n:164"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<a id="nxs:165" class="idref" href="#nxs:165"><span class="id" title="binder">nxs</span></a>:<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="lec_13_norm.html#X:163"><span class="id" title="variable">X</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="lec_13_norm.html#X:163"><span class="id" title="variable">X</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="lec_13_norm.html#nxs:165"><span class="id" title="variable">nxs</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;| (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">nxs'</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="definition">eqb_string</span> <span class="id" title="var">n'</span> <a class="idref" href="lec_13_norm.html#n:164"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="lec_13_norm.html#drop:166"><span class="id" title="definition">drop</span></a> <a class="idref" href="lec_13_norm.html#n:164"><span class="id" title="variable">n</span></a> <span class="id" title="var">nxs'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::(</span></a><a class="idref" href="lec_13_norm.html#drop:166"><span class="id" title="definition">drop</span></a> <a class="idref" href="lec_13_norm.html#n:164"><span class="id" title="variable">n</span></a> <span class="id" title="var">nxs'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="mupdate_drop" class="idref" href="#mupdate_drop"><span class="id" title="lemma">mupdate_drop</span></a> : <span class="id" title="keyword">forall</span> (<a id="c:168" class="idref" href="#c:168"><span class="id" title="binder">c</span></a>: <a class="idref" href="lec_13_norm.html#tass"><span class="id" title="definition">tass</span></a>) <a id="Gamma:169" class="idref" href="#Gamma:169"><span class="id" title="binder">Gamma</span></a> <a id="x:170" class="idref" href="#x:170"><span class="id" title="binder">x</span></a> <a id="x':171" class="idref" href="#x':171"><span class="id" title="binder">x'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#mupdate"><span class="id" title="definition">mupdate</span></a> <a class="idref" href="lec_13_norm.html#Gamma:169"><span class="id" title="variable">Gamma</span></a> (<a class="idref" href="lec_13_norm.html#drop"><span class="id" title="definition">drop</span></a> <a class="idref" href="lec_13_norm.html#x:170"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#c:168"><span class="id" title="variable">c</span></a>) <a class="idref" href="lec_13_norm.html#x':171"><span class="id" title="variable">x'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="keyword">if</span> <span class="id" title="definition">eqb_string</span> <a class="idref" href="lec_13_norm.html#x:170"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#x':171"><span class="id" title="variable">x'</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="lec_13_norm.html#Gamma:169"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#x':171"><span class="id" title="variable">x'</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="lec_13_norm.html#mupdate"><span class="id" title="definition">mupdate</span></a> <a class="idref" href="lec_13_norm.html#Gamma:169"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#c:168"><span class="id" title="variable">c</span></a> <a class="idref" href="lec_13_norm.html#x':171"><span class="id" title="variable">x'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">update</span>, <span class="id" title="definition">t_update</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="definition">update</span>, <span class="id" title="definition">t_update</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">s</span> <span class="id" title="var">x'</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">false_eqb_string</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab44"></a><h3 class="section">A Series of Substitution Lemmas</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Substitution of variables might feel like an intuitive concept, but
     it is the heart of logic + programming.

</li>
<li> All the properties of capture-avoid substitution need to be
     proved.

</li>
<li> All the issues with proofs of meta-theoretic properties either
     work or break due to variables.

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Substitution of a variable that is not free is idempotent.

</li>
</ul>

<div class="paragraph"> </div>

   <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" title="var">t'</span></span>t = t whenever x  fv(t)

<div class="paragraph"> </div>

 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="vacuous_substitution" class="idref" href="#vacuous_substitution"><span class="id" title="lemma">vacuous_substitution</span></a> : <span class="id" title="keyword">forall</span> <a id="t:172" class="idref" href="#t:172"><span class="id" title="binder">t</span></a> <a id="x:173" class="idref" href="#x:173"><span class="id" title="binder">x</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:173"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#t:172"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;<span class="id" title="keyword">forall</span> <a id="t':174" class="idref" href="#t':174"><span class="id" title="binder">t'</span></a>, <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:173"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#t':174"><span class="id" title="variable">t'</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t:172"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#t:172"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof:&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;even&nbsp;though&nbsp;appears_free_in&nbsp;is&nbsp;inductively&nbsp;defined,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;is&nbsp;negated&nbsp;so&nbsp;we&nbsp;cannot&nbsp;perform&nbsp;induction&nbsp;on&nbsp;it.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;structure&nbsp;of&nbsp;terms!<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;x:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;t1&nbsp;t2:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <span class="id" title="var">x</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">t1</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> ) <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <span class="id" title="var">x</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">t2</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> ) <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHt1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHt2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;\x:&nbsp;T,&nbsp;t:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;true:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;false:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;if&nbsp;t1&nbsp;then&nbsp;t2&nbsp;else&nbsp;t3&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <span class="id" title="var">x</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">t1</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> ) <span class="id" title="keyword">as</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <span class="id" title="var">x</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">t2</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> ) <span class="id" title="keyword">as</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <span class="id" title="var">x</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">t3</span> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> ) <span class="id" title="keyword">as</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHt1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHt2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHt3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Substitution&nbsp;is&nbsp;always&nbsp;idempotent&nbsp;on&nbsp;a&nbsp;closed&nbsp;term.<br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_closed" class="idref" href="#subst_closed"><span class="id" title="lemma">subst_closed</span></a>: <span class="id" title="keyword">forall</span> <a id="t:175" class="idref" href="#t:175"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <a class="idref" href="lec_13_norm.html#t:175"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="x:176" class="idref" href="#x:176"><span class="id" title="binder">x</span></a> <a id="t':177" class="idref" href="#t':177"><span class="id" title="binder">t'</span></a>, <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:176"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#t':177"><span class="id" title="variable">t'</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t:175"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#t:175"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#vacuous_substitution"><span class="id" title="lemma">vacuous_substitution</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Substitution&nbsp;of&nbsp;a&nbsp;closed&nbsp;term&nbsp;for&nbsp;a&nbsp;variable&nbsp;eliminates<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;mentions&nbsp;of&nbsp;that&nbsp;variable.<br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_not_afi" class="idref" href="#subst_not_afi"><span class="id" title="lemma">subst_not_afi</span></a> : <span class="id" title="keyword">forall</span> <a id="t:178" class="idref" href="#t:178"><span class="id" title="binder">t</span></a> <a id="x:179" class="idref" href="#x:179"><span class="id" title="binder">x</span></a> <a id="v:180" class="idref" href="#v:180"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <a class="idref" href="lec_13_norm.html#v:180"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="lec_13_norm.html#appears_free_in"><span class="id" title="inductive">appears_free_in</span></a> <a class="idref" href="lec_13_norm.html#x:179"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:179"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v:180"><span class="id" title="variable">v</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t:178"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof:<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;structure&nbsp;of&nbsp;terms.<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;x:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;t1&nbsp;t2:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;\x:&nbsp;T,&nbsp;t&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;true:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">A</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;false:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">A</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;if&nbsp;t1&nbsp;then&nbsp;t2&nbsp;else&nbsp;t3&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> Once we substitute away a variable with a closed term,
     we substitution with that variable is idempotent.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="duplicate_subst" class="idref" href="#duplicate_subst"><span class="id" title="lemma">duplicate_subst</span></a> : <span class="id" title="keyword">forall</span> <a id="t':181" class="idref" href="#t':181"><span class="id" title="binder">t'</span></a> <a id="x:182" class="idref" href="#x:182"><span class="id" title="binder">x</span></a> <a id="t:183" class="idref" href="#t:183"><span class="id" title="binder">t</span></a> <a id="v:184" class="idref" href="#v:184"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <a class="idref" href="lec_13_norm.html#v:184"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:182"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#t:183"><span class="id" title="variable">t</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:182"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v:184"><span class="id" title="variable">v</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t':181"><span class="id" title="variable">t'</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:182"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v:184"><span class="id" title="variable">v</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t':181"><span class="id" title="variable">t'</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#vacuous_substitution"><span class="id" title="lemma">vacuous_substitution</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#subst_not_afi"><span class="id" title="lemma">subst_not_afi</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> We can commute the order of substitution if the variables we are
     substituting away are distinct.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="swap_subst" class="idref" href="#swap_subst"><span class="id" title="lemma">swap_subst</span></a> : <span class="id" title="keyword">forall</span> <a id="t:185" class="idref" href="#t:185"><span class="id" title="binder">t</span></a> <a id="x:186" class="idref" href="#x:186"><span class="id" title="binder">x</span></a> <a id="x1:187" class="idref" href="#x1:187"><span class="id" title="binder">x1</span></a> <a id="v:188" class="idref" href="#v:188"><span class="id" title="binder">v</span></a> <a id="v1:189" class="idref" href="#v1:189"><span class="id" title="binder">v1</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#x:186"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="lec_13_norm.html#x1:187"><span class="id" title="variable">x1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <a class="idref" href="lec_13_norm.html#v:188"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <a class="idref" href="lec_13_norm.html#v1:189"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x1:187"><span class="id" title="variable">x1</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v1:189"><span class="id" title="variable">v1</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:186"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v:188"><span class="id" title="variable">v</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t:185"><span class="id" title="variable">t</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:186"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v:188"><span class="id" title="variable">v</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x1:187"><span class="id" title="variable">x1</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v1:189"><span class="id" title="variable">v1</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t:185"><span class="id" title="variable">t</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof:<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;structure&nbsp;of&nbsp;terms.<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;x:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x1</span> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exfalso</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">eqb_string_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#subst_closed"><span class="id" title="lemma">subst_closed</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">eqb_string_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#subst_closed"><span class="id" title="lemma">subst_closed</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">false_eqb_string</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">false_eqb_string</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;t1&nbsp;t2:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;\x:&nbsp;T,&nbsp;t&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x1</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">eqb_string_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x1</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">eqb_string_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x1</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">x1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">x</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;t&nbsp;=&nbsp;if&nbsp;t1&nbsp;then&nbsp;t2&nbsp;else&nbsp;t3&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt3</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab45"></a><h3 class="section">A Series of Multi-Substitution Lemmas</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Similar to the lecture on type inference, we'll need to extend
      lemmas on substitutions to multi-substitutions.

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Multi-substitutions in a closed term are idempotent, i.e.,

<div class="paragraph"> </div>

     (t) = t whenever t is closed.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="msubst_closed" class="idref" href="#msubst_closed"><span class="id" title="lemma">msubst_closed</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="t:190" class="idref" href="#t:190"><span class="id" title="binder">t</span></a>, <a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <a class="idref" href="lec_13_norm.html#t:190"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="ss:191" class="idref" href="#ss:191"><span class="id" title="binder">ss</span></a>, <a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:191"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#t:190"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#t:190"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#subst_closed"><span class="id" title="lemma">subst_closed</span></a>; <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab46"></a><h3 class="section">Closed Environments</h3>

</div>
<div class="code">
<span class="comment">(*<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;---------------------<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closed_env&nbsp;empty<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closed&nbsp;t&nbsp;&nbsp;&nbsp;closed_env&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;------------------------------<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closed_env&nbsp;(,&nbsp;x:&nbsp;t)<br/>
&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="closed_env" class="idref" href="#closed_env"><span class="id" title="definition">closed_env</span></a> (<a id="env:192" class="idref" href="#env:192"><span class="id" title="binder">env</span></a>:<a class="idref" href="lec_13_norm.html#env"><span class="id" title="definition">env</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="lec_13_norm.html#env:192"><span class="id" title="variable">env</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">env'</span> =&gt; <a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <span class="id" title="var">t</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="lec_13_norm.html#closed_env:193"><span class="id" title="definition">closed_env</span></a> <span class="id" title="var">env'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab47"></a><h3 class="section">Substitution Commutes?</h3>

</div>
<div class="code">
<span class="comment">(*<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" title="var">v</span></span>t)&nbsp;=&nbsp;<span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" title="var">v</span></span>((\x)(t))&nbsp;whenever&nbsp;v&nbsp;and&nbsp;&nbsp;are&nbsp;closed.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\x)&nbsp;means&nbsp;remove&nbsp;x&nbsp;from&nbsp;.<br/>
&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_msubst" class="idref" href="#subst_msubst"><span class="id" title="lemma">subst_msubst</span></a>: <span class="id" title="keyword">forall</span> <a id="env:195" class="idref" href="#env:195"><span class="id" title="binder">env</span></a> <a id="x:196" class="idref" href="#x:196"><span class="id" title="binder">x</span></a> <a id="v:197" class="idref" href="#v:197"><span class="id" title="binder">v</span></a> <a id="t:198" class="idref" href="#t:198"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;<a class="idref" href="lec_13_norm.html#closed"><span class="id" title="definition">closed</span></a> <a class="idref" href="lec_13_norm.html#v:197"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;<a class="idref" href="lec_13_norm.html#closed_env"><span class="id" title="definition">closed_env</span></a> <a class="idref" href="lec_13_norm.html#env:195"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#env:195"><span class="id" title="variable">env</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:196"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v:197"><span class="id" title="variable">v</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a><a class="idref" href="lec_13_norm.html#t:198"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">[</span></a><a class="idref" href="lec_13_norm.html#x:196"><span class="id" title="variable">x</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">:=</span></a><a class="idref" href="lec_13_norm.html#v:197"><span class="id" title="variable">v</span></a><a class="idref" href="lec_13_norm.html#83dbd6b289334c93dbc0440277d51136"><span class="id" title="notation">]</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a> <a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> (<a class="idref" href="lec_13_norm.html#drop"><span class="id" title="definition">drop</span></a> <a class="idref" href="lec_13_norm.html#x:196"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#env:195"><span class="id" title="variable">env</span></a>) <a class="idref" href="lec_13_norm.html#t:198"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> .<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">env0</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#duplicate_subst"><span class="id" title="lemma">duplicate_subst</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#swap_subst"><span class="id" title="lemma">swap_subst</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab48"></a><h3 class="section">Instantiations</h3>

<div class="paragraph"> </div>

<a id="lab49"></a><h4 class="section">Linking Concrete Environments with Contexts</h4>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Similar to how we needed a store typing to connect the types at
     locations with a concrete store, we'll need *instantiations* to
     connect concrete environments with typing contexts.

</li>
</ul>

<div class="paragraph"> </div>

 
<div class="paragraph"> </div>

<a id="lab50"></a><h4 class="section">  </h4>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We define instantiations inductively now.

</li>
</ul>

</div>
<div class="code">
<span class="comment">(*<br/>
<br/>
&nbsp;&nbsp;&nbsp;------------------&nbsp;V_nil<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;empty&nbsp;&nbsp;empty<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;&nbsp;R_{T}(v)<br/>
&nbsp;&nbsp;&nbsp;-----------------------------------&nbsp;V_cons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;x:&nbsp;v&nbsp;&nbsp;,&nbsp;x:&nbsp;T<br/>
<br/>
&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a id="instantiation" class="idref" href="#instantiation"><span class="id" title="inductive">instantiation</span></a> : <a class="idref" href="lec_13_norm.html#tass"><span class="id" title="definition">tass</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="lec_13_norm.html#env"><span class="id" title="definition">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a id="V_nil" class="idref" href="#V_nil"><span class="id" title="constructor">V_nil</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation:199"><span class="id" title="inductive">instantiation</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><br/>
| <a id="V_cons" class="idref" href="#V_cons"><span class="id" title="constructor">V_cons</span></a> : <span class="id" title="keyword">forall</span> <a id="x:201" class="idref" href="#x:201"><span class="id" title="binder">x</span></a> <a id="T:202" class="idref" href="#T:202"><span class="id" title="binder">T</span></a> <a id="v:203" class="idref" href="#v:203"><span class="id" title="binder">v</span></a> <a id="c:204" class="idref" href="#c:204"><span class="id" title="binder">c</span></a> <a id="e:205" class="idref" href="#e:205"><span class="id" title="binder">e</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#v:203"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:202"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#v:203"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation:199"><span class="id" title="inductive">instantiation</span></a> <a class="idref" href="lec_13_norm.html#c:204"><span class="id" title="variable">c</span></a> <a class="idref" href="lec_13_norm.html#e:205"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation:199"><span class="id" title="inductive">instantiation</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#x:201"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="lec_13_norm.html#T:202"><span class="id" title="variable">T</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="lec_13_norm.html#c:204"><span class="id" title="variable">c</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#x:201"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="lec_13_norm.html#v:203"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="lec_13_norm.html#e:205"><span class="id" title="variable">e</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab51"></a><h4 class="section">"Subtyping"</h4>

</div>
<div class="code">
<span class="comment">(*<br/>
<br/>
&nbsp;&nbsp;&nbsp;(,&nbsp;x:&nbsp;v)&nbsp;&nbsp;(,&nbsp;x:&nbsp;T)&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;We'll&nbsp;need&nbsp;this&nbsp;in&nbsp;lambda&nbsp;abstraction&nbsp;case.<br/>
<br/>
&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="instantiation_drop" class="idref" href="#instantiation_drop"><span class="id" title="lemma">instantiation_drop</span></a> : <span class="id" title="keyword">forall</span> <a id="c:206" class="idref" href="#c:206"><span class="id" title="binder">c</span></a> <a id="env:207" class="idref" href="#env:207"><span class="id" title="binder">env</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation"><span class="id" title="inductive">instantiation</span></a> <a class="idref" href="lec_13_norm.html#c:206"><span class="id" title="variable">c</span></a> <a class="idref" href="lec_13_norm.html#env:207"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="x:208" class="idref" href="#x:208"><span class="id" title="binder">x</span></a>, <a class="idref" href="lec_13_norm.html#instantiation"><span class="id" title="inductive">instantiation</span></a> (<a class="idref" href="lec_13_norm.html#drop"><span class="id" title="definition">drop</span></a> <a class="idref" href="lec_13_norm.html#x:208"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#c:206"><span class="id" title="variable">c</span></a>) (<a class="idref" href="lec_13_norm.html#drop"><span class="id" title="definition">drop</span></a> <a class="idref" href="lec_13_norm.html#x:208"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#env:207"><span class="id" title="variable">env</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">e</span> <span class="id" title="var">V</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">V</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#drop"><span class="id" title="definition">drop</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">eqb_string</span> <span class="id" title="var">x</span> <span class="id" title="var">x0</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab52"></a><h4 class="section">Domains Match</h4>


<div class="paragraph"> </div>

<ul class="doclist">
<li> If    then every variable in  corresponds to a value in .

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="instantiation_domains_match" class="idref" href="#instantiation_domains_match"><span class="id" title="lemma">instantiation_domains_match</span></a>: <span class="id" title="keyword">forall</span> {<a id="c:209" class="idref" href="#c:209"><span class="id" title="binder">c</span></a>} {<a id="e:210" class="idref" href="#e:210"><span class="id" title="binder">e</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation"><span class="id" title="inductive">instantiation</span></a> <a class="idref" href="lec_13_norm.html#c:209"><span class="id" title="variable">c</span></a> <a class="idref" href="lec_13_norm.html#e:210"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<a id="x:211" class="idref" href="#x:211"><span class="id" title="binder">x</span></a>} {<a id="T:212" class="idref" href="#T:212"><span class="id" title="binder">T</span></a>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="lec_13_norm.html#x:211"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#c:209"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="lec_13_norm.html#T:212"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="t:213" class="idref" href="#t:213"><span class="id" title="binder">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="lec_13_norm.html#x:211"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#e:210"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="lec_13_norm.html#t:213"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">e</span> <span class="id" title="var">V</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">V</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x0</span> <span class="id" title="var">T0</span> <span class="id" title="var">C</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">C</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">eqb_string</span> <span class="id" title="var">x</span> <span class="id" title="var">x0</span>); <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> If    then  is a closed environment.

</li>
<li> This makes sense: every value bound in  satisfies R{T} at
     the appropriate type, so it should be closed.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="instantiation_env_closed" class="idref" href="#instantiation_env_closed"><span class="id" title="lemma">instantiation_env_closed</span></a> : <span class="id" title="keyword">forall</span> <a id="c:214" class="idref" href="#c:214"><span class="id" title="binder">c</span></a> <a id="e:215" class="idref" href="#e:215"><span class="id" title="binder">e</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation"><span class="id" title="inductive">instantiation</span></a> <a class="idref" href="lec_13_norm.html#c:214"><span class="id" title="variable">c</span></a> <a class="idref" href="lec_13_norm.html#e:215"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#closed_env"><span class="id" title="definition">closed_env</span></a> <a class="idref" href="lec_13_norm.html#e:215"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">e</span> <span class="id" title="var">V</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">V</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#closed_env"><span class="id" title="definition">closed_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <a class="idref" href="lec_13_norm.html#closed_env"><span class="id" title="definition">closed_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#typable_empty__closed"><span class="id" title="lemma">typable_empty__closed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#R_typable_empty"><span class="id" title="lemma">R_typable_empty</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> If    then the domains of  and  and every value in  is
     in R{T} at the appropriate type T.

</li>
<li> This is a combination of <span class="inlinecode"><span class="id" title="var">instantiation_domain_closed</span></span> and 
     <span class="inlinecode"><span class="id" title="var">instantiation_env_closed</span></span>.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="instantiation_R" class="idref" href="#instantiation_R"><span class="id" title="lemma">instantiation_R</span></a> : <span class="id" title="keyword">forall</span> <a id="c:216" class="idref" href="#c:216"><span class="id" title="binder">c</span></a> <a id="e:217" class="idref" href="#e:217"><span class="id" title="binder">e</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation"><span class="id" title="inductive">instantiation</span></a> <a class="idref" href="lec_13_norm.html#c:216"><span class="id" title="variable">c</span></a> <a class="idref" href="lec_13_norm.html#e:217"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="x:218" class="idref" href="#x:218"><span class="id" title="binder">x</span></a> <a id="t:219" class="idref" href="#t:219"><span class="id" title="binder">t</span></a> <a id="T:220" class="idref" href="#T:220"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="lec_13_norm.html#x:218"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#c:216"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="lec_13_norm.html#T:220"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="lec_13_norm.html#x:218"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#e:217"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="lec_13_norm.html#t:219"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:220"><span class="id" title="variable">T</span></a> <a class="idref" href="lec_13_norm.html#t:219"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">e</span> <span class="id" title="var">V</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">V</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x'</span> <span class="id" title="var">t'</span> <span class="id" title="var">T'</span> <span class="id" title="var">G</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">G</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">eqb_string</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">G</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">E</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab53"></a><h3 class="section">Preservation of Types under Substitution</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> If    and   t: S then   (t): S.

</li>
<li> As we we might expect, it uses the lemma we used for preservation:
      that substitution preserves typing.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="msubst_preserves_typing" class="idref" href="#msubst_preserves_typing"><span class="id" title="lemma">msubst_preserves_typing</span></a> : <span class="id" title="keyword">forall</span> <a id="c:221" class="idref" href="#c:221"><span class="id" title="binder">c</span></a> <a id="e:222" class="idref" href="#e:222"><span class="id" title="binder">e</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation"><span class="id" title="inductive">instantiation</span></a> <a class="idref" href="lec_13_norm.html#c:221"><span class="id" title="variable">c</span></a> <a class="idref" href="lec_13_norm.html#e:222"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="Gamma:223" class="idref" href="#Gamma:223"><span class="id" title="binder">Gamma</span></a> <a id="t:224" class="idref" href="#t:224"><span class="id" title="binder">t</span></a> <a id="S:225" class="idref" href="#S:225"><span class="id" title="binder">S</span></a>, <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#mupdate"><span class="id" title="definition">mupdate</span></a> <a class="idref" href="lec_13_norm.html#Gamma:223"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#c:221"><span class="id" title="variable">c</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:224"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#S:225"><span class="id" title="variable">S</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#Gamma:223"><span class="id" title="variable">Gamma</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#e:222"><span class="id" title="variable">e</span></a> <a class="idref" href="lec_13_norm.html#t:224"><span class="id" title="variable">t</span></a><a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#S:225"><span class="id" title="variable">S</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHinstantiation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#substitution_preserves_typing"><span class="id" title="lemma">substitution_preserves_typing</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="lec_13_norm.html#R_typable_empty"><span class="id" title="lemma">R_typable_empty</span></a> <span class="id" title="var">H0</span>).<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab54"></a><h2 class="section">Back to the Fundamental Lemma</h2>


<div class="paragraph"> </div>

   Reminder of the proof strategy of strong-normalization of STLC.
   1.  empty  t: T -&gt; R{T}(t)
   2.  R{T}(t) -&gt; halts(t)

<div class="paragraph"> </div>

<ul class="doclist">
<li> 2 was easy because we baked in the condition into R{T}.

</li>
<li> We got stuck on 1, which is we needed to prove a stronger
     statement called the *Fundamental Lemma*:

<div class="paragraph"> </div>

       t: T -&gt;    -&gt; R{T}((t))

<div class="paragraph"> </div>


</li>
<li> 1 is a consequence of the Fundamental Lemma.

</li>
<li> To prove the Fundamental Lemma, we will need several congruence 
     lemmas that look very similar to the ones we used for showing
     normalization of a language without functions.

</li>
<li> You don't get something for nothing! We are proving something
     stronger and so we should expect that we also need to prove
     something similar as well.

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

<a id="lab55"></a><h3 class="section">Familiar congruence lemmas</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="multistep_App2" class="idref" href="#multistep_App2"><span class="id" title="lemma">multistep_App2</span></a> : <span class="id" title="keyword">forall</span> <a id="v:226" class="idref" href="#v:226"><span class="id" title="binder">v</span></a> <a id="t:227" class="idref" href="#t:227"><span class="id" title="binder">t</span></a> <a id="t':228" class="idref" href="#t':228"><span class="id" title="binder">t'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#value"><span class="id" title="inductive">value</span></a> <a class="idref" href="lec_13_norm.html#v:226"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#t:227"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#t':228"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#v:226"><span class="id" title="variable">v</span></a> <a class="idref" href="lec_13_norm.html#t:227"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#v:226"><span class="id" title="variable">v</span></a> <a class="idref" href="lec_13_norm.html#t':228"><span class="id" title="variable">t'</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> <span class="id" title="var">V</span> <span class="id" title="var">STM</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">STM</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="multistep_IfTrue" class="idref" href="#multistep_IfTrue"><span class="id" title="lemma">multistep_IfTrue</span></a> : <span class="id" title="keyword">forall</span> <a id="t2:229" class="idref" href="#t2:229"><span class="id" title="binder">t2</span></a> <a id="t2':230" class="idref" href="#t2':230"><span class="id" title="binder">t2'</span></a> <a id="t3:231" class="idref" href="#t3:231"><span class="id" title="binder">t3</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#t2:229"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#t2':230"><span class="id" title="variable">t2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t2:229"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t3:231"><span class="id" title="variable">t3</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#t2':230"><span class="id" title="variable">t2'</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2</span> <span class="id" title="var">t2'</span> <span class="id" title="var">t3</span> <span class="id" title="var">STM</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">STM</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="multistep_IfFalse" class="idref" href="#multistep_IfFalse"><span class="id" title="lemma">multistep_IfFalse</span></a> : <span class="id" title="keyword">forall</span> <a id="t2:232" class="idref" href="#t2:232"><span class="id" title="binder">t2</span></a> <a id="t3:233" class="idref" href="#t3:233"><span class="id" title="binder">t3</span></a> <a id="t3':234" class="idref" href="#t3':234"><span class="id" title="binder">t3'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#t3:233"><span class="id" title="variable">t3</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#t3':234"><span class="id" title="variable">t3'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'false'"><span class="id" title="notation">false</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t2:232"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t3:233"><span class="id" title="variable">t3</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="lec_13_norm.html#a781e4b1e2c022f0326182a9bd099911"><span class="id" title="notation">--&gt;*</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#t3':234"><span class="id" title="variable">t3'</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2</span> <span class="id" title="var">t2'</span> <span class="id" title="var">t3</span> <span class="id" title="var">STM</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">STM</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab56"></a><h3 class="section">A series of msubst lemmas per constructor</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> When proving normalization of the arithmetic language, we did
     not have functions and variables.

</li>
<li> Hence, we did not need these substitution lemmas below.

</li>
<li> We now get to use all the work that we did on substitutions
     and instantiations.

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

     (x) = <span class="inlinecode"><span class="id" title="var">x</span></span>  when x is in 
          = x     otherwise  

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="msubst_var" class="idref" href="#msubst_var"><span class="id" title="lemma">msubst_var</span></a>: <span class="id" title="keyword">forall</span> <a id="ss:235" class="idref" href="#ss:235"><span class="id" title="binder">ss</span></a> <a id="x:236" class="idref" href="#x:236"><span class="id" title="binder">x</span></a>,<br/>
&nbsp;<a class="idref" href="lec_13_norm.html#closed_env"><span class="id" title="definition">closed_env</span></a> <a class="idref" href="lec_13_norm.html#ss:235"><span class="id" title="variable">ss</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:235"><span class="id" title="variable">ss</span></a> (<a class="idref" href="lec_13_norm.html#tm_var"><span class="id" title="constructor">tm_var</span></a> <a class="idref" href="lec_13_norm.html#x:236"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="lec_13_norm.html#x:236"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#ss:235"><span class="id" title="variable">ss</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">t</span> =&gt; <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="lec_13_norm.html#tm_var"><span class="id" title="constructor">tm_var</span></a> <a class="idref" href="lec_13_norm.html#x:236"><span class="id" title="variable">x</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ss</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">eqb_string</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#msubst_closed"><span class="id" title="lemma">msubst_closed</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;(\x:&nbsp;T,&nbsp;t)&nbsp;=&nbsp;\x:&nbsp;T,&nbsp;(\x)(t)&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="msubst_abs" class="idref" href="#msubst_abs"><span class="id" title="lemma">msubst_abs</span></a>: <span class="id" title="keyword">forall</span> <a id="ss:237" class="idref" href="#ss:237"><span class="id" title="binder">ss</span></a> <a id="x:238" class="idref" href="#x:238"><span class="id" title="binder">x</span></a> <a id="T:239" class="idref" href="#T:239"><span class="id" title="binder">T</span></a> <a id="t:240" class="idref" href="#t:240"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:237"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a> <a class="idref" href="lec_13_norm.html#x:238"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a> <a class="idref" href="lec_13_norm.html#T:239"><span class="id" title="variable">T</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#t:240"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#x:238"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a> <a class="idref" href="lec_13_norm.html#T:239"><span class="id" title="variable">T</span></a><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a><a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> (<a class="idref" href="lec_13_norm.html#drop"><span class="id" title="definition">drop</span></a> <a class="idref" href="lec_13_norm.html#x:238"><span class="id" title="variable">x</span></a> <a class="idref" href="lec_13_norm.html#ss:237"><span class="id" title="variable">ss</span></a>) <a class="idref" href="lec_13_norm.html#t:240"><span class="id" title="variable">t</span></a><a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ss</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">eqb_string</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;(t1&nbsp;t2)&nbsp;=&nbsp;(t1)&nbsp;(t2)&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="msubst_app" class="idref" href="#msubst_app"><span class="id" title="lemma">msubst_app</span></a> : <span class="id" title="keyword">forall</span> <a id="ss:241" class="idref" href="#ss:241"><span class="id" title="binder">ss</span></a> <a id="t1:242" class="idref" href="#t1:242"><span class="id" title="binder">t1</span></a> <a id="t2:243" class="idref" href="#t2:243"><span class="id" title="binder">t2</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:241"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#t1:242"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#t2:243"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a><a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:241"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#t1:242"><span class="id" title="variable">t1</span></a><a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a><a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:241"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#t2:243"><span class="id" title="variable">t2</span></a><a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ss</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHss</span>.<br/>
&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;(true)&nbsp;=&nbsp;true&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="msubst_true" class="idref" href="#msubst_true"><span class="id" title="lemma">msubst_true</span></a>: <span class="id" title="keyword">forall</span> <a id="ss:244" class="idref" href="#ss:244"><span class="id" title="binder">ss</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:244"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ss</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;(false)&nbsp;=&nbsp;false&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="msubst_false" class="idref" href="#msubst_false"><span class="id" title="lemma">msubst_false</span></a>: <span class="id" title="keyword">forall</span> <a id="ss:245" class="idref" href="#ss:245"><span class="id" title="binder">ss</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:245"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'false'"><span class="id" title="notation">false</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'false'"><span class="id" title="notation">false</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ss</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;(if&nbsp;t1&nbsp;then&nbsp;t2&nbsp;else&nbsp;t3)&nbsp;=&nbsp;if&nbsp;(t1)&nbsp;then&nbsp;(t2)&nbsp;else&nbsp;(t3)&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="msubst_if" class="idref" href="#msubst_if"><span class="id" title="lemma">msubst_if</span></a>: <span class="id" title="keyword">forall</span> <a id="ss:246" class="idref" href="#ss:246"><span class="id" title="binder">ss</span></a> <a id="t1:247" class="idref" href="#t1:247"><span class="id" title="binder">t1</span></a> <a id="t2:248" class="idref" href="#t2:248"><span class="id" title="binder">t2</span></a> <a id="t3:249" class="idref" href="#t3:249"><span class="id" title="binder">t3</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:246"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#t1:247"><span class="id" title="variable">t1</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#t2:248"><span class="id" title="variable">t2</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#t3:249"><span class="id" title="variable">t3</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a><a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:246"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#t1:247"><span class="id" title="variable">t1</span></a><a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a><a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:246"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#t2:248"><span class="id" title="variable">t2</span></a><a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a> <a class="idref" href="lec_13_norm.html#:stlc::'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a><a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#ss:246"><span class="id" title="variable">ss</span></a> <a class="idref" href="lec_13_norm.html#t3:249"><span class="id" title="variable">t3</span></a><a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a> <a class="idref" href="lec_13_norm.html#96e24cc1b3765f349012b832d1dd22ad"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ss</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab57"></a><h3 class="section">The Fundamental Lemma</h3>

</div>
<div class="code">
<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:&nbsp;T&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;R_{T}((t))<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="msubst_R" class="idref" href="#msubst_R"><span class="id" title="lemma">msubst_R</span></a> : <span class="id" title="keyword">forall</span> <a id="c:250" class="idref" href="#c:250"><span class="id" title="binder">c</span></a> <a id="env:251" class="idref" href="#env:251"><span class="id" title="binder">env</span></a> <a id="t:252" class="idref" href="#t:252"><span class="id" title="binder">t</span></a> <a id="T:253" class="idref" href="#T:253"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">(</span></a><a class="idref" href="lec_13_norm.html#mupdate"><span class="id" title="definition">mupdate</span></a> <span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#c:250"><span class="id" title="variable">c</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">)</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:252"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:253"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#instantiation"><span class="id" title="inductive">instantiation</span></a> <a class="idref" href="lec_13_norm.html#c:250"><span class="id" title="variable">c</span></a> <a class="idref" href="lec_13_norm.html#env:251"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <a class="idref" href="lec_13_norm.html#T:253"><span class="id" title="variable">T</span></a> (<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="lec_13_norm.html#env:251"><span class="id" title="variable">env</span></a> <a class="idref" href="lec_13_norm.html#t:252"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">env0</span> <span class="id" title="var">t</span> <span class="id" title="var">T</span> <span class="id" title="var">HT</span> <span class="id" title="var">V</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">env0</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;need&nbsp;to&nbsp;generalize&nbsp;the&nbsp;hypothesis&nbsp;a&nbsp;bit&nbsp;before&nbsp;setting&nbsp;up&nbsp;the&nbsp;induction.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="lec_13_norm.html#mupdate"><span class="id" title="definition">mupdate</span></a> <span class="id" title="definition">empty</span> <span class="id" title="var">c</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Gamma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <a id="x:255" class="idref" href="#x:255"><span class="id" title="binder">x</span></a>, <span class="id" title="var">Gamma</span> <a class="idref" href="lec_13_norm.html#x:254"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="lec_13_norm.html#x:254"><span class="id" title="variable">x</span></a> <span class="id" title="var">c</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HeqGamma</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#mupdate_lookup"><span class="id" title="lemma">mupdate_lookup</span></a>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">HeqGamma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">c</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;By&nbsp;induction&nbsp;on&nbsp;the&nbsp;Typing&nbsp;Derivation&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">HT</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;{    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x)&nbsp;=&nbsp;T<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&nbsp;---------------&nbsp;T_Var<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:&nbsp;T<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;need&nbsp;to&nbsp;show&nbsp;R_{T}((x)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalently,&nbsp;we&nbsp;need&nbsp;to&nbsp;show&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;empty&nbsp;&nbsp;(x)&nbsp;:&nbsp;T<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;halts&nbsp;(x).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;&nbsp;&nbsp;,&nbsp;we&nbsp;have&nbsp;that&nbsp;(x)&nbsp;satisfies&nbsp;R_{T}(x)&nbsp;by&nbsp;instantiation_R.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thus&nbsp;this&nbsp;proves&nbsp;1&nbsp;and&nbsp;2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="lec_13_norm.html#instantiation_domains_match"><span class="id" title="lemma">instantiation_domains_match</span></a> <span class="id" title="var">V</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">P</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#instantiation_R"><span class="id" title="lemma">instantiation_R</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#msubst_var"><span class="id" title="lemma">msubst_var</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">P</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#instantiation_env_closed"><span class="id" title="lemma">instantiation_env_closed</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;x:&nbsp;T2&nbsp;&nbsp;t1&nbsp;:&nbsp;T1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&nbsp;---------------------------&nbsp;T_Abs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\x:&nbsp;T2,&nbsp;t1:&nbsp;T2&nbsp;-&gt;&nbsp;T1<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;need&nbsp;to&nbsp;show&nbsp;R_{T2&nbsp;-&gt;&nbsp;T1}((\x:&nbsp;T2,&nbsp;t1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalently&nbsp;we&nbsp;need&nbsp;to&nbsp;show&nbsp;R_{T2&nbsp;-&gt;&nbsp;T1}(\x:&nbsp;T2,&nbsp;(\x)(t1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#msubst_abs"><span class="id" title="lemma">msubst_abs</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;First&nbsp;we&nbsp;show&nbsp;an&nbsp;intermediate&nbsp;fact:<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;empty&nbsp;&nbsp;\x&nbsp;:&nbsp;T2,&nbsp;(\x)(t1)&nbsp;:&nbsp;T2&nbsp;-&gt;&nbsp;T1<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;follows&nbsp;by&nbsp;all&nbsp;the&nbsp;properties&nbsp;of&nbsp;&nbsp;we&nbsp;have&nbsp;established&nbsp;before.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">WT</span> : <span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">\</span></a><span class="id" title="var">x</span> <a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">:</span></a> <span class="id" title="var">T2</span><a class="idref" href="lec_13_norm.html#c7ca0fe7e4f2c0ef6d6958a5dc4283b7"><span class="id" title="notation">,</span></a> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">{</span></a><a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> (<a class="idref" href="lec_13_norm.html#drop"><span class="id" title="definition">drop</span></a> <span class="id" title="var">x</span> <span class="id" title="var">env0</span>) <span class="id" title="var">t1</span> <a class="idref" href="lec_13_norm.html#45164e50103cb4f5a6f30f892835b135"><span class="id" title="notation">}</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">(</span></a><span class="id" title="var">T2</span> <a class="idref" href="lec_13_norm.html#:stlc::x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">T1</span><a class="idref" href="lec_13_norm.html#b1345b4aefd9f042fe48f55d08e97df9"><span class="id" title="notation">)</span></a> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#T_Abs"><span class="id" title="constructor">T_Abs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#msubst_preserves_typing"><span class="id" title="lemma">msubst_preserves_typing</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#instantiation_drop"><span class="id" title="lemma">instantiation_drop</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#context_invariance"><span class="id" title="lemma">context_invariance</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">update</span>, <span class="id" title="definition">t_update</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#mupdate_drop"><span class="id" title="lemma">mupdate_drop</span></a>. <span class="id" title="tactic">destruct</span> (<span class="id" title="axiom">eqb_stringP</span> <span class="id" title="var">x</span> <span class="id" title="var">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> - <span class="id" title="var">c</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">false_eqb_string</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="definition">update</span>, <span class="id" title="definition">t_update</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">eqb_string</span> <span class="id" title="var">s</span> <span class="id" title="var">x0</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;equivalently&nbsp;show&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;empty&nbsp;&nbsp;\x:&nbsp;T2,&nbsp;(\x)(t1)&nbsp;:&nbsp;T2&nbsp;-&gt;&nbsp;T1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;halts&nbsp;(\x:&nbsp;T2,&nbsp;(\x)(t1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;R_{T2}(s)&nbsp;-&gt;&nbsp;R_{T1}((\x:&nbsp;T2,&nbsp;(\x)(t1))&nbsp;s)&nbsp;for&nbsp;any&nbsp;s.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a>. <span class="id" title="tactic">fold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;follows&nbsp;by&nbsp;the&nbsp;intermediate&nbsp;fact.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;lambda&nbsp;is&nbsp;a&nbsp;value&nbsp;and&nbsp;values&nbsp;halt.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#value_halts"><span class="id" title="lemma">value_halts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#v_abs"><span class="id" title="constructor">v_abs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All&nbsp;the&nbsp;hard&nbsp;work&nbsp;we&nbsp;put&nbsp;into&nbsp;setting&nbsp;up&nbsp;the&nbsp;logical&nbsp;relation<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comes&nbsp;down&nbsp;to&nbsp;making&nbsp;the&nbsp;proof&nbsp;work&nbsp;in&nbsp;item&nbsp;3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;have&nbsp;that&nbsp;R_{T2}(s)&nbsp;so&nbsp;we&nbsp;know&nbsp;that&nbsp;there&nbsp;is&nbsp;some&nbsp;value&nbsp;v&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;--&gt;*&nbsp;v.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;forward&nbsp;reduction,&nbsp;we&nbsp;have&nbsp;that&nbsp;R_{T2}(v).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="lec_13_norm.html#R_halts"><span class="id" title="lemma">R_halts</span></a> <span class="id" title="var">H0</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> [<span class="id" title="var">P</span> <span class="id" title="var">Q</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="lec_13_norm.html#multistep_preserves_R"><span class="id" title="lemma">multistep_preserves_R</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">P</span> <span class="id" title="var">H0</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;now&nbsp;need&nbsp;to&nbsp;show&nbsp;that&nbsp;R_{T1}(\x:&nbsp;T2,&nbsp;(\x)(t1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;holds&nbsp;by&nbsp;backward&nbsp;reduction!<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#multistep_preserves_R'"><span class="id" title="lemma">multistep_preserves_R'</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">env0</span>) <span class="id" title="var">t1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#T_App"><span class="id" title="constructor">T_App</span></a>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#R_typable_empty"><span class="id" title="lemma">R_typable_empty</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">multi_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#multistep_App2"><span class="id" title="lemma">multistep_App2</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">multi_R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#subst_msubst"><span class="id" title="lemma">subst_msubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#ST_AppAbs"><span class="id" title="constructor">ST_AppAbs</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#typable_empty__closed"><span class="id" title="lemma">typable_empty__closed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="lec_13_norm.html#R_typable_empty"><span class="id" title="lemma">R_typable_empty</span></a> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#instantiation_env_closed"><span class="id" title="lemma">instantiation_env_closed</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">IHHT</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">T2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="definition">update</span>, <span class="id" title="definition">t_update</span>, <a class="idref" href="lec_13_norm.html#lookup"><span class="id" title="definition">lookup</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">eqb_string</span> <span class="id" title="var">x</span> <span class="id" title="var">x0</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t1&nbsp;:&nbsp;T2&nbsp;-&gt;&nbsp;T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2&nbsp;:&nbsp;T2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&nbsp;------------------------------------&nbsp;T_App<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t1&nbsp;t2:&nbsp;T1<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;need&nbsp;to&nbsp;show&nbsp;R_{T1}((t1&nbsp;t2)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;msubst_app,&nbsp;we&nbsp;can&nbsp;equivalently&nbsp;show&nbsp;R_{T1}((t1)&nbsp;(t2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;follows&nbsp;by&nbsp;our&nbsp;induction&nbsp;hypothesis.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;this&nbsp;is&nbsp;where&nbsp;we&nbsp;got&nbsp;stuck&nbsp;last&nbsp;time!<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;case&nbsp;is&nbsp;now&nbsp;trivially&nbsp;solved&nbsp;by&nbsp;our&nbsp;inductive&nbsp;hypthesis.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All&nbsp;the&nbsp;"pain"&nbsp;was&nbsp;transferred&nbsp;to&nbsp;the&nbsp;lambda&nbsp;case.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#msubst_app"><span class="id" title="lemma">msubst_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHT1</span> <span class="id" title="var">c</span> <span class="id" title="var">H</span> <span class="id" title="var">env0</span> <span class="id" title="var">V</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> [<span class="id" title="var">_</span> <span class="id" title="var">P1</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IHHT2</span> <span class="id" title="var">c</span> <span class="id" title="var">H</span> <span class="id" title="var">env0</span> <span class="id" title="var">V</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">P2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <a class="idref" href="lec_13_norm.html#R"><span class="id" title="definition">R</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">P1</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&nbsp;-------------------&nbsp;T_True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;:&nbsp;Bool<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;need&nbsp;to&nbsp;show&nbsp;R_{Bool}((true)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalently,&nbsp;we&nbsp;need&nbsp;to&nbsp;show&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;empty&nbsp;&nbsp;(true)&nbsp;:&nbsp;Bool<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;halts&nbsp;(true).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;1&nbsp;follows&nbsp;because&nbsp;&nbsp;substitution&nbsp;preserves&nbsp;typing.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#msubst_preserves_typing"><span class="id" title="lemma">msubst_preserves_typing</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;2&nbsp;follows&nbsp;because&nbsp;(true)&nbsp;=&nbsp;true&nbsp;is&nbsp;a&nbsp;value&nbsp;and&nbsp;values&nbsp;halt.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#value_halts"><span class="id" title="lemma">value_halts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#msubst_true"><span class="id" title="lemma">msubst_true</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&nbsp;--------------------&nbsp;T_False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;:&nbsp;Bool<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;need&nbsp;to&nbsp;show&nbsp;R_{Bool}((false)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalently,&nbsp;we&nbsp;need&nbsp;to&nbsp;show&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;empty&nbsp;&nbsp;(false)&nbsp;:&nbsp;Bool<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;halts&nbsp;(false).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;1&nbsp;follows&nbsp;because&nbsp;&nbsp;substitution&nbsp;preserves&nbsp;typing.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#msubst_preserves_typing"><span class="id" title="lemma">msubst_preserves_typing</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;2&nbsp;follows&nbsp;because&nbsp;(false)&nbsp;=&nbsp;false&nbsp;is&nbsp;a&nbsp;value&nbsp;and&nbsp;values&nbsp;halt.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="lec_13_norm.html#value_halts"><span class="id" title="lemma">value_halts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#msubst_false"><span class="id" title="lemma">msubst_false</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t1&nbsp;:&nbsp;Bool&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2&nbsp;:&nbsp;T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t3&nbsp;:&nbsp;T&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&nbsp;--------------------------------------------&nbsp;T_If<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;t1&nbsp;then&nbsp;t2&nbsp;else&nbsp;t3&nbsp;:&nbsp;T<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="lec_13_norm.html#msubst_if"><span class="id" title="lemma">msubst_if</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Exercise&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab58"></a><h3 class="section">Finally Strong Normalization</h3>


<div class="paragraph"> </div>

   Putting the pieces together
   1.  empty  t: T -&gt; R{T}(t)
   2.  R{T}(t) -&gt; halts(t)

<div class="paragraph"> </div>


</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="normalization" class="idref" href="#normalization"><span class="id" title="lemma">normalization</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="t:256" class="idref" href="#t:256"><span class="id" title="binder">t</span></a> <a id="T:257" class="idref" href="#T:257"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">empty</span> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation"></span></a> <a class="idref" href="lec_13_norm.html#t:256"><span class="id" title="variable">t</span></a> <a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">\</span></a><a class="idref" href="lec_13_norm.html#aa8312987d2180c84572f43708410ddc"><span class="id" title="notation">in</span></a> <a class="idref" href="lec_13_norm.html#T:257"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="lec_13_norm.html#halts"><span class="id" title="definition">halts</span></a> <a class="idref" href="lec_13_norm.html#t:256"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> (<a class="idref" href="lec_13_norm.html#msubst"><span class="id" title="definition">msubst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> <span class="id" title="var">t</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<a class="idref" href="lec_13_norm.html#R_halts"><span class="id" title="lemma">R_halts</span></a> <span class="id" title="var">T</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="lec_13_norm.html#msubst_R"><span class="id" title="axiom">msubst_R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="lec_13_norm.html#V_nil"><span class="id" title="constructor">V_nil</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab59"></a><h2 class="section">Type-Safety Using Logical Relations</h2>

<div class="paragraph"> </div>

<a id="lab60"></a><h3 class="section">Types</h3>

</div>
<div class="code">
<span class="comment">(*<br/>
<br/>
&nbsp;&nbsp;V<span class="inlinecode"><span class="id" title="var">Bool</span></span>&nbsp;:=&nbsp;{true,&nbsp;false}<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;V<span class="inlinecode"><span class="id" title="var">T1</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">T2</span></span>&nbsp;:=&nbsp;{&nbsp;\x:T1,&nbsp;t&nbsp;|&nbsp;&nbsp;v&nbsp;&nbsp;V<span class="inlinecode"><span class="id" title="var">T1</span></span>,&nbsp;<span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" title="var">v</span></span>t&nbsp;&nbsp;V<span class="inlinecode"><span class="id" title="var">T2</span></span>&nbsp;}<br/>
<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="definition">normal_form</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab61"></a><h3 class="section">Logical Relation</h3>

</div>
<div class="code">
<span class="comment">(*<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;E<span class="inlinecode"><span class="id" title="var">T</span></span>&nbsp;:=&nbsp;{&nbsp;t&nbsp;|&nbsp;&nbsp;t',&nbsp;t&nbsp;--&gt;*&nbsp;t'&nbsp;/\&nbsp;normal_form(t)&nbsp;-&gt;&nbsp;t'&nbsp;&nbsp;V<span class="inlinecode"><span class="id" title="var">T</span></span>&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab62"></a><h3 class="section">Safety</h3>

</div>
<div class="code">
<span class="comment">(*<br/>
<br/>
&nbsp;&nbsp;safe(t)&nbsp;:=&nbsp;&nbsp;t',&nbsp;t&nbsp;--&gt;*&nbsp;t'&nbsp;-&gt;&nbsp;value&nbsp;t'&nbsp;\/&nbsp;&nbsp;t''.&nbsp;t'&nbsp;--&gt;&nbsp;t''<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab63"></a><h3 class="section">Proof Setup</h3>

</div>
<div class="code">
<span class="comment">(*<br/>
<br/>
&nbsp;&nbsp;&nbsp;1.&nbsp;empty&nbsp;&nbsp;t:&nbsp;T&nbsp;-&gt;&nbsp;t&nbsp;&nbsp;E<span class="inlinecode"><span class="id" title="var">T</span></span><br/>
&nbsp;&nbsp;&nbsp;2.&nbsp;t&nbsp;&nbsp;E<span class="inlinecode"><span class="id" title="var">T</span></span>&nbsp;-&gt;&nbsp;safe(t)<br/>
&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:&nbsp;T&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;(t)&nbsp;&nbsp;E_{T}<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab64"></a><h2 class="section">Summary</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> We introduced the idea of <i>logical relations</i>, a powerful proof technique
     that can be used to obtain a stronger induction hypothesis.

</li>
<li> We saw how this technique can be used to show that STLC is strongly normalizing,
     i.e., that every well-typed STLC term terminates.

</li>
</ul>

<div class="paragraph"> </div>

 
</div>
<div class="code">
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>